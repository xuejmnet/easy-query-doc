import{_ as n}from"./plugin-vue_export-helper-c27b6911.js";import{o as s,c as a,f as t}from"./app-05c74fad.js";const p={},c=t(`<p><code>PARTITION BY</code>是数据库的一个<code>窗口函数</code>,部分数据库可能不支持或者低版本数据库不支持，请结合具体数据库使用</p><h2 id="提供api" tabindex="-1"><a class="header-anchor" href="#提供api" aria-hidden="true">#</a> 提供api</h2><h2 id="方法" tabindex="-1"><a class="header-anchor" href="#方法" aria-hidden="true">#</a> 方法</h2><p>rowNumberOver<br> rankOver<br> denseRankOver<br> countOver<br> sumOver<br> avgOver<br> maxOver<br> minOver</p><h2 id="初始化数据表结构" tabindex="-1"><a class="header-anchor" href="#初始化数据表结构" aria-hidden="true">#</a> 初始化数据表结构</h2><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>
<span class="token annotation punctuation">@Getter</span>
<span class="token annotation punctuation">@Setter</span>
<span class="token annotation punctuation">@Table</span><span class="token punctuation">(</span><span class="token string">&quot;t_blog&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@EntityProxy</span>
<span class="token annotation punctuation">@ToString</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DocBlog</span> <span class="token keyword">implements</span> <span class="token class-name">ProxyEntityAvailable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">DocBlog</span> <span class="token punctuation">,</span> <span class="token class-name">DocBlogProxy</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>primaryKey <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> id<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * 标题
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> title<span class="token punctuation">;</span>
    <span class="token doc-comment comment">/**
     * 主题
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> topic<span class="token punctuation">;</span>
    <span class="token doc-comment comment">/**
     * 博客链接
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> url<span class="token punctuation">;</span>
    <span class="token doc-comment comment">/**
     * 点赞数
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> star<span class="token punctuation">;</span>
    <span class="token doc-comment comment">/**
     * 发布时间
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">LocalDateTime</span> publishTime<span class="token punctuation">;</span>
    <span class="token doc-comment comment">/**
     * 评分
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">BigDecimal</span> score<span class="token punctuation">;</span>
    <span class="token doc-comment comment">/**
     * 状态
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> status<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="案例1" tabindex="-1"><a class="header-anchor" href="#案例1" aria-hidden="true">#</a> 案例1</h2><p>查询2024年博客,并且求出每个主题下的各个博客分数,排名</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">//默认只有Partition1-2如果有更多需要的可以提交issue</span>
<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Partition1</span><span class="token punctuation">&lt;</span><span class="token class-name">DocBlog</span><span class="token punctuation">,</span> <span class="token class-name">Long</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> easyEntityQuery<span class="token punctuation">.</span><span class="token function">queryable</span><span class="token punctuation">(</span><span class="token class-name">DocBlog</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span>d <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            d<span class="token punctuation">.</span><span class="token function">publishTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">gt</span><span class="token punctuation">(</span><span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token number">2024</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span>d <span class="token operator">-&gt;</span> <span class="token class-name">Select</span><span class="token punctuation">.</span><span class="token constant">PARTITION</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>
                d<span class="token punctuation">,</span>
                d<span class="token punctuation">.</span><span class="token function">expression</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">rowNumberOver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">partitionBy</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span><span class="token function">topic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">orderByDescending</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span><span class="token function">score</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//Partition1结构式{entity:{},partitionColumn1:object}</span>

<span class="token operator">--</span> 第<span class="token number">1</span>条sql数据
<span class="token constant">SELECT</span>
    t<span class="token punctuation">.</span>\`id\`<span class="token punctuation">,</span>
    t<span class="token punctuation">.</span>\`title\`<span class="token punctuation">,</span>
    t<span class="token punctuation">.</span>\`topic\`<span class="token punctuation">,</span>
    t<span class="token punctuation">.</span>\`url\`<span class="token punctuation">,</span>
    t<span class="token punctuation">.</span>\`star\`<span class="token punctuation">,</span>
    t<span class="token punctuation">.</span>\`publish_time\`<span class="token punctuation">,</span>
    t<span class="token punctuation">.</span>\`score\`<span class="token punctuation">,</span>
    t<span class="token punctuation">.</span>\`status\`<span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token function">ROW_NUMBER</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token constant">OVER</span> <span class="token punctuation">(</span><span class="token constant">PARTITION</span> <span class="token constant">BY</span> t<span class="token punctuation">.</span>\`topic\` <span class="token constant">ORDER</span> <span class="token constant">BY</span> t<span class="token punctuation">.</span>\`score\` <span class="token constant">DESC</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token constant">AS</span> \`__partition__column1\` 
<span class="token constant">FROM</span>
    \`t_blog\` t 
<span class="token constant">WHERE</span>
    t<span class="token punctuation">.</span>\`publish_time\` <span class="token operator">&gt;</span> &#39;<span class="token number">2024</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">01</span> <span class="token number">00</span><span class="token operator">:</span><span class="token number">00</span>&#39;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="案例2" tabindex="-1"><a class="header-anchor" href="#案例2" aria-hidden="true">#</a> 案例2</h2><p>求出查询2024年博客,并且求出每个主题下的各个博客分数和点赞数,返回得分前3位并且点赞数最后5位的博客</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">//不返回排名直接返回对象</span>
  <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">DocBlog</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> easyEntityQuery<span class="token punctuation">.</span><span class="token function">queryable</span><span class="token punctuation">(</span><span class="token class-name">DocBlog</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span>d <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
                    d<span class="token punctuation">.</span><span class="token function">publishTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">gt</span><span class="token punctuation">(</span><span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token number">2024</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span>d <span class="token operator">-&gt;</span> <span class="token class-name">Select</span><span class="token punctuation">.</span><span class="token constant">PARTITION</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>
                        d<span class="token punctuation">,</span>
                        d<span class="token punctuation">.</span><span class="token function">expression</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">rowNumberOver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">partitionBy</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span><span class="token function">topic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">orderByDescending</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span><span class="token function">score</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">nullOrDefault</span><span class="token punctuation">(</span><span class="token class-name">BigDecimal</span><span class="token punctuation">.</span><span class="token constant">ZERO</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                        d<span class="token punctuation">.</span><span class="token function">expression</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">rowNumberOver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">partitionBy</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span><span class="token function">topic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">orderBy</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span><span class="token function">star</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">nullOrDefault</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span>p2 <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
                    p2<span class="token punctuation">.</span><span class="token function">partitionColumn1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">le</span><span class="token punctuation">(</span><span class="token number">3L</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    p2<span class="token punctuation">.</span><span class="token function">partitionColumn2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">le</span><span class="token punctuation">(</span><span class="token number">5L</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span>p2 <span class="token operator">-&gt;</span> p2<span class="token punctuation">.</span><span class="token function">entityTable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token operator">--</span> 第<span class="token number">1</span>条sql数据
<span class="token constant">SELECT</span>
    t1<span class="token punctuation">.</span>\`id\`<span class="token punctuation">,</span>
    t1<span class="token punctuation">.</span>\`title\`<span class="token punctuation">,</span>
    t1<span class="token punctuation">.</span>\`topic\`<span class="token punctuation">,</span>
    t1<span class="token punctuation">.</span>\`url\`<span class="token punctuation">,</span>
    t1<span class="token punctuation">.</span>\`star\`<span class="token punctuation">,</span>
    t1<span class="token punctuation">.</span>\`publish_time\`<span class="token punctuation">,</span>
    t1<span class="token punctuation">.</span>\`score\`<span class="token punctuation">,</span>
    t1<span class="token punctuation">.</span>\`status\` 
<span class="token constant">FROM</span>
    <span class="token punctuation">(</span><span class="token constant">SELECT</span>
        t<span class="token punctuation">.</span>\`id\`<span class="token punctuation">,</span>
        t<span class="token punctuation">.</span>\`title\`<span class="token punctuation">,</span>
        t<span class="token punctuation">.</span>\`topic\`<span class="token punctuation">,</span>
        t<span class="token punctuation">.</span>\`url\`<span class="token punctuation">,</span>
        t<span class="token punctuation">.</span>\`star\`<span class="token punctuation">,</span>
        t<span class="token punctuation">.</span>\`publish_time\`<span class="token punctuation">,</span>
        t<span class="token punctuation">.</span>\`score\`<span class="token punctuation">,</span>
        t<span class="token punctuation">.</span>\`status\`<span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token function">ROW_NUMBER</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token constant">OVER</span> <span class="token punctuation">(</span><span class="token constant">PARTITION</span> <span class="token constant">BY</span> t<span class="token punctuation">.</span>\`topic\` <span class="token constant">ORDER</span> <span class="token class-name">BY</span> <span class="token function">IFNULL</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>\`score\`<span class="token punctuation">,</span> <span class="token char">&#39;0&#39;</span><span class="token punctuation">)</span> <span class="token constant">DESC</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token constant">AS</span> \`__partition__column1\`<span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token function">ROW_NUMBER</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token constant">OVER</span> <span class="token punctuation">(</span><span class="token constant">PARTITION</span> <span class="token constant">BY</span> t<span class="token punctuation">.</span>\`topic\` <span class="token constant">ORDER</span> <span class="token class-name">BY</span> <span class="token function">IFNULL</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>\`star\`<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token constant">ASC</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token constant">AS</span> \`__partition__column2\` 
    <span class="token constant">FROM</span>
        \`t_blog\` t 
    <span class="token constant">WHERE</span>
        t<span class="token punctuation">.</span>\`publish_time\` <span class="token operator">&gt;</span> &#39;<span class="token number">2024</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">01</span> <span class="token number">00</span><span class="token operator">:</span><span class="token number">00</span>&#39;<span class="token punctuation">)</span> t1 
<span class="token constant">WHERE</span>
    t1<span class="token punctuation">.</span>\`__partition__column1\` <span class="token operator">&lt;=</span> <span class="token number">3</span> 
    <span class="token constant">AND</span> t1<span class="token punctuation">.</span>\`__partition__column2\` <span class="token operator">&lt;=</span> <span class="token number">5</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Partition2</span><span class="token punctuation">&lt;</span><span class="token class-name">DocBlog</span><span class="token punctuation">,</span> <span class="token class-name">Long</span><span class="token punctuation">,</span> <span class="token class-name">Long</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> easyEntityQuery<span class="token punctuation">.</span><span class="token function">queryable</span><span class="token punctuation">(</span><span class="token class-name">DocBlog</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span>d <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
                    d<span class="token punctuation">.</span><span class="token function">publishTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">gt</span><span class="token punctuation">(</span><span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token number">2024</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span>d <span class="token operator">-&gt;</span> <span class="token class-name">Select</span><span class="token punctuation">.</span><span class="token constant">PARTITION</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>
                        d<span class="token punctuation">,</span>
                        d<span class="token punctuation">.</span><span class="token function">expression</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">rowNumberOver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">partitionBy</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span><span class="token function">topic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">orderByDescending</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span><span class="token function">score</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">nullOrDefault</span><span class="token punctuation">(</span><span class="token class-name">BigDecimal</span><span class="token punctuation">.</span><span class="token constant">ZERO</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                        d<span class="token punctuation">.</span><span class="token function">expression</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">rowNumberOver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">partitionBy</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span><span class="token function">topic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">orderBy</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span><span class="token function">star</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">nullOrDefault</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span>p2 <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
                    p2<span class="token punctuation">.</span><span class="token function">partitionColumn1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">le</span><span class="token punctuation">(</span><span class="token number">3L</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    p2<span class="token punctuation">.</span><span class="token function">partitionColumn2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">le</span><span class="token punctuation">(</span><span class="token number">5L</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>



<span class="token operator">--</span> 第<span class="token number">1</span>条sql数据
<span class="token constant">SELECT</span>
    t1<span class="token punctuation">.</span>\`id\`<span class="token punctuation">,</span>
    t1<span class="token punctuation">.</span>\`title\`<span class="token punctuation">,</span>
    t1<span class="token punctuation">.</span>\`topic\`<span class="token punctuation">,</span>
    t1<span class="token punctuation">.</span>\`url\`<span class="token punctuation">,</span>
    t1<span class="token punctuation">.</span>\`star\`<span class="token punctuation">,</span>
    t1<span class="token punctuation">.</span>\`publish_time\`<span class="token punctuation">,</span>
    t1<span class="token punctuation">.</span>\`score\`<span class="token punctuation">,</span>
    t1<span class="token punctuation">.</span>\`status\`<span class="token punctuation">,</span>
    t1<span class="token punctuation">.</span>\`__partition__column1\` <span class="token constant">AS</span> \`__partition__column1\`<span class="token punctuation">,</span>
    t1<span class="token punctuation">.</span>\`__partition__column2\` <span class="token constant">AS</span> \`__partition__column2\` 
<span class="token constant">FROM</span>
    <span class="token punctuation">(</span><span class="token constant">SELECT</span>
        t<span class="token punctuation">.</span>\`id\`<span class="token punctuation">,</span>
        t<span class="token punctuation">.</span>\`title\`<span class="token punctuation">,</span>
        t<span class="token punctuation">.</span>\`topic\`<span class="token punctuation">,</span>
        t<span class="token punctuation">.</span>\`url\`<span class="token punctuation">,</span>
        t<span class="token punctuation">.</span>\`star\`<span class="token punctuation">,</span>
        t<span class="token punctuation">.</span>\`publish_time\`<span class="token punctuation">,</span>
        t<span class="token punctuation">.</span>\`score\`<span class="token punctuation">,</span>
        t<span class="token punctuation">.</span>\`status\`<span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token function">ROW_NUMBER</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token constant">OVER</span> <span class="token punctuation">(</span><span class="token constant">PARTITION</span> <span class="token constant">BY</span> t<span class="token punctuation">.</span>\`topic\` <span class="token constant">ORDER</span> <span class="token class-name">BY</span> <span class="token function">IFNULL</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>\`score\`<span class="token punctuation">,</span> <span class="token char">&#39;0&#39;</span><span class="token punctuation">)</span> <span class="token constant">DESC</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token constant">AS</span> \`__partition__column1\`<span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token function">ROW_NUMBER</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token constant">OVER</span> <span class="token punctuation">(</span><span class="token constant">PARTITION</span> <span class="token constant">BY</span> t<span class="token punctuation">.</span>\`topic\` <span class="token constant">ORDER</span> <span class="token class-name">BY</span> <span class="token function">IFNULL</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>\`star\`<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token constant">ASC</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token constant">AS</span> \`__partition__column2\` 
    <span class="token constant">FROM</span>
        \`t_blog\` t 
    <span class="token constant">WHERE</span>
        t<span class="token punctuation">.</span>\`publish_time\` <span class="token operator">&gt;</span> &#39;<span class="token number">2024</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">01</span> <span class="token number">00</span><span class="token operator">:</span><span class="token number">00</span>&#39;<span class="token punctuation">)</span> t1 
<span class="token constant">WHERE</span>
    t1<span class="token punctuation">.</span>\`__partition__column1\` <span class="token operator">&lt;=</span> <span class="token number">3</span> 
    <span class="token constant">AND</span> t1<span class="token punctuation">.</span>\`__partition__column2\` <span class="token operator">&lt;=</span> <span class="token number">5</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,13),o=[c];function e(u,l){return s(),a("div",null,o)}const r=n(p,[["render",e],["__file","partition.html.vue"]]);export{r as default};
