import{_ as c}from"./plugin-vue_export-helper-c27b6911.js";import{r as e,o as i,c as l,a as n,b as s,d as t,w as u,e as a}from"./app-a17c5889.js";const r={},k=n("h1",{id:"springboot配置",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#springboot配置","aria-hidden":"true"},"#"),s(" SpringBoot配置")],-1),d=n("h2",{id:"获取最新",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#获取最新","aria-hidden":"true"},"#"),s(" 获取最新")],-1),v={href:"https://central.sonatype.com/",target:"_blank",rel:"noopener noreferrer"},m=n("code",null,"com.easy-query",-1),g=a(`<h2 id="spring-boot工程" tabindex="-1"><a class="header-anchor" href="#spring-boot工程" aria-hidden="true">#</a> spring-boot工程</h2><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>easy-query.version</span><span class="token punctuation">&gt;</span></span>latest-version<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>easy-query.version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.easy-query<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>sql-springboot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>\${easy-query.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token comment">#配置文件</span>
<span class="token key atrule">easy-query</span><span class="token punctuation">:</span>
  <span class="token comment">#是否启动默认true</span>
  <span class="token key atrule">enable</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
  <span class="token comment">#支持的数据库</span>
  <span class="token key atrule">database</span><span class="token punctuation">:</span> mysql
  <span class="token comment">#对象属性和数据库列名的转换器</span>
  <span class="token key atrule">name-conversion</span><span class="token punctuation">:</span> underlined
  <span class="token comment">#当执行物理删除是否报错,true表示报错,false表示不报错,默认true,如果配置为true,可以通过allowDeleteStament来实现允许</span>
  <span class="token key atrule">delete-throw</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
  <span class="token comment">#是否打印sql 默认true 需要配置log信息才可以 默认实现sl4jimpl</span>
  <span class="token key atrule">print-sql</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
  <span class="token comment">#sqlNativeSegment输入和格式化无需处理单引号会自动处理为双单引号</span>
  <span class="token key atrule">keep-native-style</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">//依赖注入</span>
<span class="token annotation punctuation">@Autowired</span>
<span class="token keyword">private</span> <span class="token class-name">EasyQueryClient</span> easyQueryClient<span class="token punctuation">;</span><span class="token comment">//通过字符串属性方式来实现查询</span>

<span class="token comment">//推荐</span>
<span class="token annotation punctuation">@Autowired</span>
<span class="token keyword">private</span> <span class="token class-name">EasyQuery</span> easyQuery<span class="token punctuation">;</span><span class="token comment">//对EasyQueryClient的增强通过lambda方式实现查询(推荐)</span>

<span class="token comment">//推荐</span>
<span class="token annotation punctuation">@Autowired</span>
<span class="token keyword">private</span> <span class="token class-name">EasyProxyQuery</span> easyProxyQuery<span class="token punctuation">;</span><span class="token comment">//对EasyQueryClient的增强通过apt代理模式实现强类型(推荐)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="springboot多数据源" tabindex="-1"><a class="header-anchor" href="#springboot多数据源" aria-hidden="true">#</a> springboot多数据源</h2><p>因为<code>easy-query</code>默认仅支持单数据源如果需要支持多数据源可以通过手动构建<code>EasyQuery</code>的Bean实例</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>    <span class="token annotation punctuation">@Bean</span><span class="token punctuation">(</span><span class="token string">&quot;ds2&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">EasyQuery</span> <span class="token function">easyQuery</span><span class="token punctuation">(</span><span class="token class-name">DataSource</span> dataSource<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">EasyQueryClient</span> easyQueryClient <span class="token operator">=</span> <span class="token class-name">EasyQueryBootstrapper</span><span class="token punctuation">.</span><span class="token function">defaultBuilderConfiguration</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setDefaultDataSource</span><span class="token punctuation">(</span>dataSource<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">replaceService</span><span class="token punctuation">(</span><span class="token class-name">DataSourceUnitFactory</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">SpringDataSourceUnitFactory</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token comment">//springboot下必须用来支持事务</span>
                <span class="token punctuation">.</span><span class="token function">replaceService</span><span class="token punctuation">(</span><span class="token class-name">ConnectionManager</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">SpringConnectionManager</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token comment">//springboot下必须用来支持事务</span>
                <span class="token punctuation">.</span><span class="token function">replaceService</span><span class="token punctuation">(</span><span class="token class-name">NameConversion</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">UnderlinedNameConversion</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">optionConfigure</span><span class="token punctuation">(</span>builder <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
                    builder<span class="token punctuation">.</span><span class="token function">setDeleteThrowError</span><span class="token punctuation">(</span>easyQueryProperties<span class="token punctuation">.</span><span class="token function">getDeleteThrow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    builder<span class="token punctuation">.</span><span class="token function">setInsertStrategy</span><span class="token punctuation">(</span>easyQueryProperties<span class="token punctuation">.</span><span class="token function">getInsertStrategy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    builder<span class="token punctuation">.</span><span class="token function">setUpdateStrategy</span><span class="token punctuation">(</span>easyQueryProperties<span class="token punctuation">.</span><span class="token function">getUpdateStrategy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    builder<span class="token punctuation">.</span><span class="token function">setMaxShardingQueryLimit</span><span class="token punctuation">(</span>easyQueryProperties<span class="token punctuation">.</span><span class="token function">getMaxShardingQueryLimit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    builder<span class="token punctuation">.</span><span class="token function">setExecutorMaximumPoolSize</span><span class="token punctuation">(</span>easyQueryProperties<span class="token punctuation">.</span><span class="token function">getExecutorMaximumPoolSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    builder<span class="token punctuation">.</span><span class="token function">setExecutorCorePoolSize</span><span class="token punctuation">(</span>easyQueryProperties<span class="token punctuation">.</span><span class="token function">getExecutorCorePoolSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    builder<span class="token punctuation">.</span><span class="token function">setThrowIfRouteNotMatch</span><span class="token punctuation">(</span>easyQueryProperties<span class="token punctuation">.</span><span class="token function">isThrowIfRouteNotMatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    builder<span class="token punctuation">.</span><span class="token function">setShardingExecuteTimeoutMillis</span><span class="token punctuation">(</span>easyQueryProperties<span class="token punctuation">.</span><span class="token function">getShardingExecuteTimeoutMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    builder<span class="token punctuation">.</span><span class="token function">setQueryLargeColumn</span><span class="token punctuation">(</span>easyQueryProperties<span class="token punctuation">.</span><span class="token function">isQueryLargeColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    builder<span class="token punctuation">.</span><span class="token function">setMaxShardingRouteCount</span><span class="token punctuation">(</span>easyQueryProperties<span class="token punctuation">.</span><span class="token function">getMaxShardingRouteCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    builder<span class="token punctuation">.</span><span class="token function">setExecutorQueueSize</span><span class="token punctuation">(</span>easyQueryProperties<span class="token punctuation">.</span><span class="token function">getExecutorQueueSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    builder<span class="token punctuation">.</span><span class="token function">setDefaultDataSourceName</span><span class="token punctuation">(</span>easyQueryProperties<span class="token punctuation">.</span><span class="token function">getDefaultDataSourceName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    builder<span class="token punctuation">.</span><span class="token function">setDefaultDataSourceMergePoolSize</span><span class="token punctuation">(</span>easyQueryProperties<span class="token punctuation">.</span><span class="token function">getDefaultDataSourceMergePoolSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    builder<span class="token punctuation">.</span><span class="token function">setMultiConnWaitTimeoutMillis</span><span class="token punctuation">(</span>easyQueryProperties<span class="token punctuation">.</span><span class="token function">getMultiConnWaitTimeoutMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    builder<span class="token punctuation">.</span><span class="token function">setWarningBusy</span><span class="token punctuation">(</span>easyQueryProperties<span class="token punctuation">.</span><span class="token function">isWarningBusy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    builder<span class="token punctuation">.</span><span class="token function">setInsertBatchThreshold</span><span class="token punctuation">(</span>easyQueryProperties<span class="token punctuation">.</span><span class="token function">getInsertBatchThreshold</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    builder<span class="token punctuation">.</span><span class="token function">setUpdateBatchThreshold</span><span class="token punctuation">(</span>easyQueryProperties<span class="token punctuation">.</span><span class="token function">getUpdateBatchThreshold</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    builder<span class="token punctuation">.</span><span class="token function">setPrintSql</span><span class="token punctuation">(</span>easyQueryProperties<span class="token punctuation">.</span><span class="token function">isPrintSql</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    builder<span class="token punctuation">.</span><span class="token function">setStartTimeJob</span><span class="token punctuation">(</span>easyQueryProperties<span class="token punctuation">.</span><span class="token function">isStartTimeJob</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    builder<span class="token punctuation">.</span><span class="token function">setDefaultTrack</span><span class="token punctuation">(</span>easyQueryProperties<span class="token punctuation">.</span><span class="token function">isDefaultTrack</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    builder<span class="token punctuation">.</span><span class="token function">setRelationGroupSize</span><span class="token punctuation">(</span>easyQueryProperties<span class="token punctuation">.</span><span class="token function">getRelationGroupSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    builder<span class="token punctuation">.</span><span class="token function">setNoVersionError</span><span class="token punctuation">(</span>easyQueryProperties<span class="token punctuation">.</span><span class="token function">isNoVersionError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">useDatabaseConfigure</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">MySQLDatabaseConfiguration</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//         QueryConfiguration queryConfiguration = easyQueryClient.getRuntimeContext().getQueryConfiguration();</span>

<span class="token comment">//         configuration.applyEncryptionStrategy(new DefaultAesEasyEncryptionStrategy());</span>
<span class="token comment">//         configuration.applyEncryptionStrategy(new Base64EncryptionStrategy());</span>
<span class="token comment">//         configuration.applyEncryptionStrategy(new MyEncryptionStrategy());</span>
<span class="token comment">//         configuration.applyEncryptionStrategy(new JavaEncryptionStrategy());</span>
<span class="token comment">//         configuration.applyLogicDeleteStrategy(new MyLogicDelStrategy());</span>
<span class="token comment">//         configuration.applyInterceptor(new MyEntityInterceptor());</span>
<span class="token comment">//         configuration.applyInterceptor(new Topic1Interceptor());</span>
<span class="token comment">//         configuration.applyInterceptor(new MyTenantInterceptor());</span>
<span class="token comment">// //        configuration.applyShardingInitializer(new FixShardingInitializer());</span>
<span class="token comment">//         configuration.applyShardingInitializer(new DataSourceAndTableShardingInitializer());</span>
<span class="token comment">//         configuration.applyShardingInitializer(new TopicShardingShardingInitializer());</span>
<span class="token comment">//         configuration.applyShardingInitializer(new TopicShardingTimeShardingInitializer());</span>
<span class="token comment">//         configuration.applyShardingInitializer(new DataSourceShardingInitializer());</span>
<span class="token comment">//         configuration.applyValueConverter(new EnumConverter());</span>
<span class="token comment">//         configuration.applyValueConverter(new JsonConverter());</span>
<span class="token comment">//         configuration.applyValueUpdateAtomicTrack(new IntegerNotValueUpdateAtomicTrack());</span>
<span class="token comment">//         configuration.applyColumnValueSQLConverter(new MySQLAesEncryptColumnValueSQLConverter());</span>
<span class="token comment">//         configuration.applyGeneratedKeySQLColumnGenerator(new MyDatabaseIncrementSQLColumnGenerator());</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">EasyQuery</span><span class="token punctuation">(</span>easyQueryClient<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="springboot-启动报错" tabindex="-1"><a class="header-anchor" href="#springboot-启动报错" aria-hidden="true">#</a> SpringBoot 启动报错</h2><div class="hint-container danger"><p class="hint-container-title">注意</p><blockquote><p>因为默认添加了track的aop如果启动报错那么就添加一下aop</p></blockquote></div><div class="language-log line-numbers-mode" data-ext="log"><pre class="language-log"><code><span class="token exception javastacktrace language-javastacktrace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>IllegalStateException<span class="token punctuation">:</span> Unable to load cache item
	<span class="token keyword">at</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>cglib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>internal<span class="token punctuation">.</span>LoadingCache<span class="token punctuation">.</span><span class="token function">createEntry</span><span class="token punctuation">(</span>LoadingCache<span class="token punctuation">.</span>java<span class="token punctuation">:</span>79<span class="token punctuation">)</span> ~[spring-core-5<span class="token punctuation">.</span>3<span class="token punctuation">.</span>29<span class="token punctuation">.</span>jar<span class="token punctuation">:</span>5<span class="token punctuation">.</span>3<span class="token punctuation">.</span>29]
	<span class="token keyword">at</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>cglib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>internal<span class="token punctuation">.</span>LoadingCache<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>LoadingCache<span class="token punctuation">.</span>java<span class="token punctuation">:</span>34<span class="token punctuation">)</span> ~[spring-core-5<span class="token punctuation">.</span>3<span class="token punctuation">.</span>29<span class="token punctuation">.</span>jar<span class="token punctuation">:</span>5<span class="token punctuation">.</span>3<span class="token punctuation">.</span>29]
	<span class="token keyword">at</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>cglib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>AbstractClassGenerator$ClassLoaderData<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>AbstractClassGenerator<span class="token punctuation">.</span>java<span class="token punctuation">:</span>134<span class="token punctuation">)</span> ~[spring-core-5<span class="token punctuation">.</span>3<span class="token punctuation">.</span>29<span class="token punctuation">.</span>jar<span class="token punctuation">:</span>5<span class="token punctuation">.</span>3<span class="token punctuation">.</span>29]
	<span class="token keyword">at</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>cglib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>AbstractClassGenerator<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>AbstractClassGenerator<span class="token punctuation">.</span>java<span class="token punctuation">:</span>319<span class="token punctuation">)</span> ~[spring-core-5<span class="token punctuation">.</span>3<span class="token punctuation">.</span>29<span class="token punctuation">.</span>jar<span class="token punctuation">:</span>5<span class="token punctuation">.</span>3<span class="token punctuation">.</span>29]
	<span class="token keyword">at</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>cglib<span class="token punctuation">.</span>proxy<span class="token punctuation">.</span>Enhancer<span class="token punctuation">.</span><span class="token function">createHelper</span><span class="token punctuation">(</span>Enhancer<span class="token punctuation">.</span>java<span class="token punctuation">:</span>572<span class="token punctuation">)</span> ~[spring-core-5<span class="token punctuation">.</span>3<span class="token punctuation">.</span>29<span class="token punctuation">.</span>jar<span class="token punctuation">:</span>5<span class="token punctuation">.</span>3<span class="token punctuation">.</span>29]
	<span class="token keyword">at</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>cglib<span class="token punctuation">.</span>proxy<span class="token punctuation">.</span>Enhancer<span class="token punctuation">.</span><span class="token function">createClass</span><span class="token punctuation">(</span>Enhancer<span class="token punctuation">.</span>java<span class="token punctuation">:</span>419<span class="token punctuation">)</span> ~[spring-core-5<span class="token punctuation">.</span>3<span class="token punctuation">.</span>29<span class="token punctuation">.</span>jar<span class="token punctuation">:</span>5<span class="token punctuation">.</span>3<span class="token punctuation">.</span>29]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>主要原因是</p><ul><li>缺少aop依赖</li><li>aop组件版本不对</li></ul><p>解决办法添加对应的依赖</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-aop<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="多数据源" tabindex="-1"><a class="header-anchor" href="#多数据源" aria-hidden="true">#</a> 多数据源</h2><p>默认仅支持单个数据源的处理</p><p>用户也可以自行构建其他数据库或者其他数据源的<code>easy-query</code></p><div class="hint-container warning"><p class="hint-container-title">注意点及说明!!!</p><blockquote><p>注意自行构建的数据源如果<code>DataSource</code>不是被spring接管的<code>Bean</code>那么事务将不会生效</p></blockquote></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>
<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyConfiguration</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Bean</span><span class="token punctuation">(</span><span class="token string">&quot;myeq&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">EasyQuery</span> <span class="token function">easyQuery1</span><span class="token punctuation">(</span><span class="token class-name">DataSource</span> dataSource<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//数据源是你要的即可</span>
        <span class="token class-name">EasyQueryClient</span> easyQueryClient <span class="token operator">=</span> <span class="token class-name">EasyQueryBootstrapper</span><span class="token punctuation">.</span><span class="token function">defaultBuilderConfiguration</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setDefaultDataSource</span><span class="token punctuation">(</span>dataSource<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">replaceService</span><span class="token punctuation">(</span><span class="token class-name">DataSourceUnitFactory</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">SpringDataSourceUnitFactory</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token comment">//支持spring事务</span>
                <span class="token punctuation">.</span><span class="token function">replaceService</span><span class="token punctuation">(</span><span class="token class-name">ConnectionManager</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">SpringConnectionManager</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token comment">//支持spring事务</span>
                <span class="token punctuation">.</span><span class="token function">replaceService</span><span class="token punctuation">(</span><span class="token class-name">NameConversion</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">UnderlinedNameConversion</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">optionConfigure</span><span class="token punctuation">(</span>builder <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
                    <span class="token comment">//配置和springboot的配置一样</span>
                    builder<span class="token punctuation">.</span><span class="token function">setDeleteThrowError</span><span class="token punctuation">(</span>easyQueryProperties<span class="token punctuation">.</span><span class="token function">getDeleteThrow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    builder<span class="token punctuation">.</span><span class="token function">setInsertStrategy</span><span class="token punctuation">(</span>easyQueryProperties<span class="token punctuation">.</span><span class="token function">getInsertStrategy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    builder<span class="token punctuation">.</span><span class="token function">setUpdateStrategy</span><span class="token punctuation">(</span>easyQueryProperties<span class="token punctuation">.</span><span class="token function">getUpdateStrategy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    builder<span class="token punctuation">.</span><span class="token function">setMaxShardingQueryLimit</span><span class="token punctuation">(</span>easyQueryProperties<span class="token punctuation">.</span><span class="token function">getMaxShardingQueryLimit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    builder<span class="token punctuation">.</span><span class="token function">setExecutorMaximumPoolSize</span><span class="token punctuation">(</span>easyQueryProperties<span class="token punctuation">.</span><span class="token function">getExecutorMaximumPoolSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    builder<span class="token punctuation">.</span><span class="token function">setExecutorCorePoolSize</span><span class="token punctuation">(</span>easyQueryProperties<span class="token punctuation">.</span><span class="token function">getExecutorCorePoolSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    builder<span class="token punctuation">.</span><span class="token function">setThrowIfRouteNotMatch</span><span class="token punctuation">(</span>easyQueryProperties<span class="token punctuation">.</span><span class="token function">isThrowIfRouteNotMatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    builder<span class="token punctuation">.</span><span class="token function">setShardingExecuteTimeoutMillis</span><span class="token punctuation">(</span>easyQueryProperties<span class="token punctuation">.</span><span class="token function">getShardingExecuteTimeoutMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    builder<span class="token punctuation">.</span><span class="token function">setQueryLargeColumn</span><span class="token punctuation">(</span>easyQueryProperties<span class="token punctuation">.</span><span class="token function">isQueryLargeColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    builder<span class="token punctuation">.</span><span class="token function">setMaxShardingRouteCount</span><span class="token punctuation">(</span>easyQueryProperties<span class="token punctuation">.</span><span class="token function">getMaxShardingRouteCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    builder<span class="token punctuation">.</span><span class="token function">setExecutorQueueSize</span><span class="token punctuation">(</span>easyQueryProperties<span class="token punctuation">.</span><span class="token function">getExecutorQueueSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    builder<span class="token punctuation">.</span><span class="token function">setDefaultDataSourceName</span><span class="token punctuation">(</span>easyQueryProperties<span class="token punctuation">.</span><span class="token function">getDefaultDataSourceName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    builder<span class="token punctuation">.</span><span class="token function">setDefaultDataSourceMergePoolSize</span><span class="token punctuation">(</span>easyQueryProperties<span class="token punctuation">.</span><span class="token function">getDefaultDataSourceMergePoolSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    builder<span class="token punctuation">.</span><span class="token function">setMultiConnWaitTimeoutMillis</span><span class="token punctuation">(</span>easyQueryProperties<span class="token punctuation">.</span><span class="token function">getMultiConnWaitTimeoutMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    builder<span class="token punctuation">.</span><span class="token function">setWarningBusy</span><span class="token punctuation">(</span>easyQueryProperties<span class="token punctuation">.</span><span class="token function">isWarningBusy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    builder<span class="token punctuation">.</span><span class="token function">setInsertBatchThreshold</span><span class="token punctuation">(</span>easyQueryProperties<span class="token punctuation">.</span><span class="token function">getInsertBatchThreshold</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    builder<span class="token punctuation">.</span><span class="token function">setUpdateBatchThreshold</span><span class="token punctuation">(</span>easyQueryProperties<span class="token punctuation">.</span><span class="token function">getUpdateBatchThreshold</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    builder<span class="token punctuation">.</span><span class="token function">setPrintSql</span><span class="token punctuation">(</span>easyQueryProperties<span class="token punctuation">.</span><span class="token function">isPrintSql</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    builder<span class="token punctuation">.</span><span class="token function">setStartTimeJob</span><span class="token punctuation">(</span>easyQueryProperties<span class="token punctuation">.</span><span class="token function">isStartTimeJob</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    builder<span class="token punctuation">.</span><span class="token function">setDefaultTrack</span><span class="token punctuation">(</span>easyQueryProperties<span class="token punctuation">.</span><span class="token function">isDefaultTrack</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    builder<span class="token punctuation">.</span><span class="token function">setRelationGroupSize</span><span class="token punctuation">(</span>easyQueryProperties<span class="token punctuation">.</span><span class="token function">getRelationGroupSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    builder<span class="token punctuation">.</span><span class="token function">setNoVersionError</span><span class="token punctuation">(</span>easyQueryProperties<span class="token punctuation">.</span><span class="token function">isNoVersionError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">useDatabaseConfigure</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">OracleDatabaseConfiguration</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">DefaultEasyQuery</span><span class="token punctuation">(</span>easyQueryClient<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,19),b={class:"hint-container warning"},y=n("p",{class:"hint-container-title"},"说明!!!",-1),f=n("code",null,"QueryConfiguration",-1),S=n("code",null,"springboot",-1),h=n("code",null,"easy-query",-1),w=n("code",null,"@Component",-1),Q=n("code",null,"solon",-1),C=n("br",null,null,-1),M=n("code",null,"easy-query",-1),I=a(`<div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">QueryRuntimeContext</span> runtimeContext <span class="token operator">=</span> easyQuery<span class="token punctuation">.</span><span class="token function">getRuntimeContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">QueryConfiguration</span> configuration <span class="token operator">=</span> runtimeContext<span class="token punctuation">.</span><span class="token function">getQueryConfiguration</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
configuration<span class="token punctuation">.</span><span class="token function">applyEncryptionStrategy</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">DefaultAesEasyEncryptionStrategy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
configuration<span class="token punctuation">.</span><span class="token function">applyLogicDeleteStrategy</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">MyLogicDelStrategy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
configuration<span class="token punctuation">.</span><span class="token function">applyInterceptor</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">MyEntityInterceptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
configuration<span class="token punctuation">.</span><span class="token function">applyShardingInitializer</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">DataSourceAndTableShardingInitializer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
configuration<span class="token punctuation">.</span><span class="token function">applyValueConverter</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">EnumConverter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
configuration<span class="token punctuation">.</span><span class="token function">applyColumnValueSQLConverter</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">MySQLAesEncryptColumnValueSQLConverter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
configuration<span class="token punctuation">.</span><span class="token function">applyGeneratedKeySQLColumnGenerator</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">MyDatabaseIncrementSQLColumnGenerator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">TableRouteManager</span> tableRouteManager <span class="token operator">=</span> runtimeContext<span class="token punctuation">.</span><span class="token function">getTableRouteManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
tableRouteManager<span class="token punctuation">.</span><span class="token function">addRoute</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">TopicShardingTableRoute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">DataSourceRouteManager</span> dataSourceRouteManager <span class="token operator">=</span> runtimeContext<span class="token punctuation">.</span><span class="token function">getDataSourceRouteManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
dataSourceRouteManager<span class="token punctuation">.</span><span class="token function">addRoute</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">TopicShardingDataSourceTimeDataSourceRoute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),x=a(`<div class="language-log line-numbers-mode" data-ext="log"><pre class="language-log"><code><span class="token property">Caused by:</span> <span class="token property">org.springframework.beans.factory.UnsatisfiedDependencyException:</span> Error creating bean with name <span class="token string">&#39;easyQueryInitializeOption&#39;</span> defined in class path resource <span class="token punctuation">[</span>com<span class="token operator">/</span>easy<span class="token operator">/</span>query<span class="token operator">/</span>sql<span class="token operator">/</span>starter<span class="token operator">/</span>EasyQueryStarterAutoConfiguration<span class="token punctuation">.</span>class<span class="token punctuation">]</span><span class="token operator">:</span> Unsatisfied dependency expressed through method <span class="token string">&#39;easyQueryInitializeOption&#39;</span> parameter <span class="token number">1</span><span class="token operator">;</span> nested exception is org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>NoSuchBeanDefinitionException<span class="token operator">:</span> No qualifying bean of type <span class="token string">&#39;java.util.Map&lt;java.lang.String, com.easy.query.core.basic.extension.version.VersionStrategy&gt;&#39;</span> <span class="token property">available:</span> expected at least <span class="token number">1</span> bean which qualifies as autowire candidate<span class="token punctuation">.</span> Dependency annotations<span class="token operator">:</span> <span class="token operator">{</span><span class="token operator">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>可能是springboot版本太低导致没有的依赖不是以空map返回而是报错</p><p>建议重写bean</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">//    @Bean</span>
<span class="token comment">//    @ConditionalOnMissingBean</span>
<span class="token comment">//    public EasyQueryInitializeOption easyQueryInitializeOption(Map&lt;String, Interceptor&gt; interceptorMap,</span>
<span class="token comment">//                                                               Map&lt;String, VersionStrategy&gt; versionStrategyMap,</span>
<span class="token comment">//                                                               Map&lt;String, LogicDeleteStrategy&gt; logicDeleteStrategyMap,</span>
<span class="token comment">//                                                               Map&lt;String, ShardingInitializer&gt; shardingInitializerMap,</span>
<span class="token comment">//                                                               Map&lt;String, EncryptionStrategy&gt; encryptionStrategyMap,</span>
<span class="token comment">//                                                               Map&lt;String, ValueConverter&lt;?, ?&gt;&gt; valueConverterMap,</span>
<span class="token comment">//                                                               Map&lt;String, TableRoute&lt;?&gt;&gt; tableRouteMap,</span>
<span class="token comment">//                                                               Map&lt;String, DataSourceRoute&lt;?&gt;&gt; dataSourceRouteMap,</span>
<span class="token comment">//                                                               Map&lt;String, ValueUpdateAtomicTrack&lt;?&gt;&gt; valueUpdateAtomicTrackMap,</span>
<span class="token comment">//                                                               Map&lt;String, JdbcTypeHandler&gt; jdbcTypeHandlerMap,</span>
<span class="token comment">//                                                               Map&lt;String, ColumnValueSQLConverter&gt; columnValueSQLConverterMap,</span>
<span class="token comment">//                                                               Map&lt;String, IncrementSQLColumnGenerator&gt; incrementSQLColumnGeneratorMap</span>
<span class="token comment">//    ) {</span>
<span class="token comment">//        return new EasyQueryInitializeOption(interceptorMap,</span>
<span class="token comment">//                versionStrategyMap,</span>
<span class="token comment">//                logicDeleteStrategyMap,</span>
<span class="token comment">//                shardingInitializerMap,</span>
<span class="token comment">//                encryptionStrategyMap,</span>
<span class="token comment">//                valueConverterMap,</span>
<span class="token comment">//                tableRouteMap,</span>
<span class="token comment">//                dataSourceRouteMap,</span>
<span class="token comment">//                valueUpdateAtomicTrackMap,</span>
<span class="token comment">//                jdbcTypeHandlerMap,</span>
<span class="token comment">//                columnValueSQLConverterMap,</span>
<span class="token comment">//                incrementSQLColumnGeneratorMap);</span>
<span class="token comment">//    }</span>


    <span class="token annotation punctuation">@Bean</span>
    <span class="token annotation punctuation">@Primary</span>
    <span class="token keyword">public</span> <span class="token class-name">EasyQueryInitializeOption</span> <span class="token function">easyQueryInitializeOption</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Interceptor</span><span class="token punctuation">&gt;</span></span> interceptorMap
    <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">EasyQueryInitializeOption</span><span class="token punctuation">(</span>interceptorMap<span class="token punctuation">,</span>
                versionStrategyMap<span class="token punctuation">,</span>
                <span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">emptyMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">emptyMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">emptyMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">emptyMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">emptyMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">emptyMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">emptyMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">emptyMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">emptyMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">emptyMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h1 id="无依赖配置" tabindex="-1"><a class="header-anchor" href="#无依赖配置" aria-hidden="true">#</a> 无依赖配置</h1><p>有些用户喜欢拥有非常强的强迫症,这边给出如何自行处理实现类starter,无依赖引入<code>easy-query</code></p><h2 id="创建springboot应用" tabindex="-1"><a class="header-anchor" href="#创建springboot应用" aria-hidden="true">#</a> 创建springboot应用</h2>`,7),D={href:"https://start.spring.io/",target:"_blank",rel:"noopener noreferrer"},E=a(`<h2 id="添加依赖" tabindex="-1"><a class="header-anchor" href="#添加依赖" aria-hidden="true">#</a> 添加依赖</h2><h3 id="属性模式" tabindex="-1"><a class="header-anchor" href="#属性模式" aria-hidden="true">#</a> 属性模式</h3><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code>	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-jdbc<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.easy-query<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>sql-core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.7.10<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!--		自己选择对应的驱动--&gt;</span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.easy-query<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>sql-mysql<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.7.10<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
		<span class="token comment">&lt;!-- mysql驱动 --&gt;</span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>mysql<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mysql-connector-java<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>8.0.31<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="代理模式" tabindex="-1"><a class="header-anchor" href="#代理模式" aria-hidden="true">#</a> 代理模式</h3><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code>	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-jdbc<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.easy-query<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>sql-core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.7.10<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!--		代理模式--&gt;</span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.easy-query<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>sql-api-proxy<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.7.10<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!--		自己选择对应的驱动--&gt;</span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.easy-query<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>sql-mysql<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.7.10<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!--		用来生成代理对象--&gt;</span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.easy-query<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>sql-processor<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.7.10<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
		<span class="token comment">&lt;!-- mysql驱动 --&gt;</span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>mysql<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mysql-connector-java<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>8.0.31<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="添加配置" tabindex="-1"><a class="header-anchor" href="#添加配置" aria-hidden="true">#</a> 添加配置</h2><p>首先我们如果需要支持springboot的事务需要再<code>easy-query</code>的<code>springboot-strater</code>处拷贝三个源码文件</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SpringConnectionManager</span> <span class="token keyword">extends</span> <span class="token class-name">DefaultConnectionManager</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token class-name">SpringConnectionManager</span><span class="token punctuation">(</span><span class="token class-name">EasyQueryDataSource</span> easyDataSource<span class="token punctuation">,</span> <span class="token class-name">EasyConnectionFactory</span> easyConnectionFactory<span class="token punctuation">,</span> <span class="token class-name">EasyDataSourceConnectionFactory</span> easyDataSourceConnectionFactory<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>easyDataSource<span class="token punctuation">,</span> easyConnectionFactory<span class="token punctuation">,</span> easyDataSourceConnectionFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">currentThreadInTransaction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">TransactionSynchronizationManager</span><span class="token punctuation">.</span><span class="token function">isActualTransactionActive</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token function">isOpenTransaction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">closeEasyConnection</span><span class="token punctuation">(</span><span class="token class-name">EasyConnection</span> easyConnection<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>easyConnection<span class="token operator">==</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//当前没开事务,但是easy query手动开启了</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">TransactionSynchronizationManager</span><span class="token punctuation">.</span><span class="token function">isActualTransactionActive</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">isOpenTransaction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">isOpenTransaction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">EasyQueryException</span><span class="token punctuation">(</span><span class="token string">&quot;repeat transaction can&#39;t closed connection&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">DataSourceWrapper</span> dataSourceUnit <span class="token operator">=</span> easyDataSource<span class="token punctuation">.</span><span class="token function">getDataSourceNotNull</span><span class="token punctuation">(</span>easyConnection<span class="token punctuation">.</span><span class="token function">getDataSourceName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">ConnectionStrategyEnum<span class="token punctuation">.</span>ShareConnection</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">DataSourceUtils</span><span class="token punctuation">.</span><span class="token function">releaseConnection</span><span class="token punctuation">(</span>easyConnection<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dataSourceUnit<span class="token punctuation">.</span><span class="token function">getDataSourceUnit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SpringDataSourceUnit</span> <span class="token keyword">extends</span> <span class="token class-name">DefaultDataSourceUnit</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">SpringDataSourceUnit</span><span class="token punctuation">(</span><span class="token class-name">String</span> dataSourceName<span class="token punctuation">,</span> <span class="token class-name">DataSource</span> dataSource<span class="token punctuation">,</span> <span class="token keyword">int</span> mergePoolSize<span class="token punctuation">,</span> <span class="token keyword">boolean</span> warningBusy<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>dataSourceName<span class="token punctuation">,</span>dataSource<span class="token punctuation">,</span>mergePoolSize<span class="token punctuation">,</span>warningBusy<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token class-name">Connection</span> <span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">DataSourceUtils</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span>dataSource<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SpringDataSourceUnitFactory</span> <span class="token keyword">implements</span> <span class="token class-name">DataSourceUnitFactory</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">EasyQueryOption</span> easyQueryOption<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">SpringDataSourceUnitFactory</span><span class="token punctuation">(</span><span class="token class-name">EasyQueryOption</span> easyQueryOption<span class="token punctuation">)</span><span class="token punctuation">{</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span>easyQueryOption <span class="token operator">=</span> easyQueryOption<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">DataSourceUnit</span> <span class="token function">createDataSourceUnit</span><span class="token punctuation">(</span><span class="token class-name">String</span> dataSourceName<span class="token punctuation">,</span> <span class="token class-name">DataSource</span> dataSource<span class="token punctuation">,</span> <span class="token keyword">int</span> mergePoolSize<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">SpringDataSourceUnit</span><span class="token punctuation">(</span>dataSourceName<span class="token punctuation">,</span>dataSource<span class="token punctuation">,</span>mergePoolSize<span class="token punctuation">,</span>easyQueryOption<span class="token punctuation">.</span><span class="token function">isWarningBusy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="注入bean" tabindex="-1"><a class="header-anchor" href="#注入bean" aria-hidden="true">#</a> 注入bean</h2><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>
<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EasyQueryConfiguration</span> <span class="token punctuation">{</span>
    
    <span class="token annotation punctuation">@Bean</span><span class="token punctuation">(</span><span class="token string">&quot;oracleDataSource&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">DataSource</span> <span class="token function">oracleDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">DataSourceBuilder</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">url</span><span class="token punctuation">(</span><span class="token string">&quot;jdbc:h2:mem:testdb&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">driverClassName</span><span class="token punctuation">(</span><span class="token string">&quot;org.h2.Driver&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">username</span><span class="token punctuation">(</span><span class="token string">&quot;sa&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">password</span><span class="token punctuation">(</span><span class="token string">&quot;password&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Bean</span><span class="token punctuation">(</span><span class="token string">&quot;orcale&quot;</span><span class="token punctuation">)</span><span class="token comment">//使用的时候通过注入指定名称即可</span>
    <span class="token keyword">public</span> <span class="token class-name">EasyQueryClient</span> <span class="token function">easyQueryClient</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Qualifier</span><span class="token punctuation">(</span><span class="token string">&quot;oracleDataSource&quot;</span><span class="token punctuation">)</span> <span class="token class-name">DataSource</span> dataSource<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">EasyQueryClient</span> easyQueryClient <span class="token operator">=</span> <span class="token class-name">EasyQueryBootstrapper</span><span class="token punctuation">.</span><span class="token function">defaultBuilderConfiguration</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setDefaultDataSource</span><span class="token punctuation">(</span>dataSource<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">replaceService</span><span class="token punctuation">(</span><span class="token class-name">DataSourceUnitFactory</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">SpringDataSourceUnitFactory</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">replaceService</span><span class="token punctuation">(</span><span class="token class-name">NameConversion</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">UnderlinedNameConversion</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">replaceService</span><span class="token punctuation">(</span><span class="token class-name">ConnectionManager</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">SpringConnectionManager</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">optionConfigure</span><span class="token punctuation">(</span>builder <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
<span class="token comment">//                    builder.setDeleteThrowError(easyQueryProperties.getDeleteThrow());</span>
<span class="token comment">//                    builder.setInsertStrategy(easyQueryProperties.getInsertStrategy());</span>
<span class="token comment">//                    builder.setUpdateStrategy(easyQueryProperties.getUpdateStrategy());</span>
<span class="token comment">//                    builder.setMaxShardingQueryLimit(easyQueryProperties.getMaxShardingQueryLimit());</span>
<span class="token comment">//                    builder.setExecutorMaximumPoolSize(easyQueryProperties.getExecutorMaximumPoolSize());</span>
<span class="token comment">//                    builder.setExecutorCorePoolSize(easyQueryProperties.getExecutorCorePoolSize());</span>
<span class="token comment">//                    builder.setThrowIfRouteNotMatch(easyQueryProperties.isThrowIfRouteNotMatch());</span>
<span class="token comment">//                    builder.setShardingExecuteTimeoutMillis(easyQueryProperties.getShardingExecuteTimeoutMillis());</span>
<span class="token comment">//                    builder.setQueryLargeColumn(easyQueryProperties.isQueryLargeColumn());</span>
<span class="token comment">//                    builder.setMaxShardingRouteCount(easyQueryProperties.getMaxShardingRouteCount());</span>
<span class="token comment">//                    builder.setExecutorQueueSize(easyQueryProperties.getExecutorQueueSize());</span>
<span class="token comment">//                    builder.setDefaultDataSourceName(easyQueryProperties.getDefaultDataSourceName());</span>
<span class="token comment">//                    builder.setDefaultDataSourceMergePoolSize(easyQueryProperties.getDefaultDataSourceMergePoolSize());</span>
<span class="token comment">//                    builder.setMultiConnWaitTimeoutMillis(easyQueryProperties.getMultiConnWaitTimeoutMillis());</span>
<span class="token comment">//                    builder.setWarningBusy(easyQueryProperties.isWarningBusy());</span>
<span class="token comment">//                    builder.setInsertBatchThreshold(easyQueryProperties.getInsertBatchThreshold());</span>
<span class="token comment">//                    builder.setUpdateBatchThreshold(easyQueryProperties.getUpdateBatchThreshold());</span>
<span class="token comment">//                    builder.setPrintSql(easyQueryProperties.isPrintSql());</span>
<span class="token comment">//                    builder.setStartTimeJob(easyQueryProperties.isStartTimeJob());</span>
<span class="token comment">//                    builder.setDefaultTrack(easyQueryProperties.isDefaultTrack());</span>
<span class="token comment">//                    builder.setRelationGroupSize(easyQueryProperties.getRelationGroupSize());</span>
<span class="token comment">//                    builder.setKeepNativeStyle(easyQueryProperties.isKeepNativeStyle());</span>
<span class="token comment">//                    builder.setNoVersionError(easyQueryProperties.isNoVersionError());</span>
<span class="token comment">//                    builder.setReverseOffsetThreshold(easyQueryProperties.getReverseOffsetThreshold());</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">useDatabaseConfigure</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">OracleDatabaseConfiguration</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> easyQueryClient<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">EasyProxyQuery</span> <span class="token function">easyProxyQuery</span><span class="token punctuation">(</span><span class="token class-name">EasyQueryClient</span> easyQueryClient<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">DefaultEasyProxyQuery</span><span class="token punctuation">(</span>easyQueryClient<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="添加配置文件" tabindex="-1"><a class="header-anchor" href="#添加配置文件" aria-hidden="true">#</a> 添加配置文件</h2><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8080</span>

<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">datasource</span><span class="token punctuation">:</span>
    <span class="token key atrule">driver-class-name</span><span class="token punctuation">:</span> com.mysql.cj.jdbc.Driver
    <span class="token key atrule">url</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>mysql<span class="token punctuation">:</span>//127.0.0.1<span class="token punctuation">:</span>3306/easy<span class="token punctuation">-</span>sharding<span class="token punctuation">-</span>test<span class="token punctuation">?</span>serverTimezone=GMT%2B8<span class="token important">&amp;characterEncoding=utf-8&amp;useSSL=false&amp;allowMultiQueries=true&amp;rewriteBatchedStatements=true</span>
    <span class="token key atrule">username</span><span class="token punctuation">:</span> root
    <span class="token key atrule">password</span><span class="token punctuation">:</span> root
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="添加控制器" tabindex="-1"><a class="header-anchor" href="#添加控制器" aria-hidden="true">#</a> 添加控制器</h2><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>
<span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/my&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyController</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">EasyProxyQuery</span> easyProxyQuery<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/test&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;hello world&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,14);function P(q,T){const p=e("ExternalLinkIcon"),o=e("RouterLink");return i(),l("div",null,[k,d,n("p",null,[n("a",v,[s("https://central.sonatype.com/"),t(p)]),s(" 搜索"),m,s("获取最新安装包")]),g,n("div",b,[y,n("blockquote",null,[n("p",null,[s("创建完拦截器后需要配置到"),f,s(",如果你是"),S,s("并且是默认"),h,s("只需要添加"),w,s("如果是"),Q,s("那么可以查看"),t(o,{to:"/guide/config/config-solon.html#solon%E6%89%80%E6%9C%89%E9%85%8D%E7%BD%AE"},{default:u(()=>[s("配置或配置到所有数据源")]),_:1}),C,s(" 如果您是自行构建的"),M,s("需要自行添加拦截器")])]),I]),x,n("p",null,[s("下载地址 "),n("a",D,[s("https://start.spring.io/"),t(p)])]),E])}const j=c(r,[["render",P],["__file","config-spring-boot.html.vue"]]);export{j as default};
