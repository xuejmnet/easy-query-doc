import{_ as c}from"./plugin-vue_export-helper-c27b6911.js";import{r,o as l,c as k,a as u,w as a,e as o,d as s,b as n}from"./app-e4979cef.js";const i={},d=o('<p><code>easy-query</code>提供了高效,高性能的分片机制,完美的屏蔽分片带来的业务复杂度,不同于<code>sharding-jdbc</code>的sql的<code>antlr</code>解析采用自带的表达式解析性能高效,并且不同于<code>ShardingSphere-Proxy</code>的代理模式,导致未分片的对象也需要走代理,并且需要多次jdbc,<code>easy-query</code>采用客户端分片保证分片下的高性能查询结果返回,并且原生orm框架自带无需使用额外组件,更少的依赖来保证程序的健壮与可控</p><h2 id="创建表" tabindex="-1"><a class="header-anchor" href="#创建表" aria-hidden="true">#</a> 创建表</h2><p>我们以订单表为例来实现订单的简单取模分表,将订单表按5取模进行分表分为t_order_00、t_order_01....t_order_04</p>',3),m=n("div",{class:"language-java line-numbers-mode","data-ext":"java"},[n("pre",{class:"language-java"},[n("code",null,[n("span",{class:"token comment"},"//数据库对象"),s(`
`),n("span",{class:"token annotation punctuation"},"@Data"),s(`
`),n("span",{class:"token annotation punctuation"},"@Table"),n("span",{class:"token punctuation"},"("),s("value "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token string"},'"order"'),n("span",{class:"token punctuation"},","),s("shardingInitializer "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token class-name"},"OrderShardingInitializer"),n("span",{class:"token punctuation"},"."),n("span",{class:"token keyword"},"class"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"public"),s(),n("span",{class:"token keyword"},"class"),s(),n("span",{class:"token class-name"},"OrderEntity"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token annotation punctuation"},"@Column"),n("span",{class:"token punctuation"},"("),s("primaryKey "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token boolean"},"true"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token annotation punctuation"},"@ShardingTableKey"),s(),n("span",{class:"token comment"},"//标记当前属性为分片键"),s(`
    `),n("span",{class:"token annotation punctuation"},"@UpdateIgnore"),s(`
    `),n("span",{class:"token keyword"},"private"),s(),n("span",{class:"token class-name"},"String"),s(" id"),n("span",{class:"token punctuation"},";"),s(`
    `),n("span",{class:"token keyword"},"private"),s(),n("span",{class:"token class-name"},"String"),s(" uid"),n("span",{class:"token punctuation"},";"),s(`
    `),n("span",{class:"token keyword"},"private"),s(),n("span",{class:"token class-name"},"Integer"),s(" orderNo"),n("span",{class:"token punctuation"},";"),s(`
    `),n("span",{class:"token keyword"},"private"),s(),n("span",{class:"token class-name"},"Integer"),s(" status"),n("span",{class:"token punctuation"},";"),s(`
    `),n("span",{class:"token keyword"},"private"),s(),n("span",{class:"token class-name"},"LocalDateTime"),s(" createTime"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

`),n("span",{class:"token comment"},"//分片初始化器,和5进行取模,获取2位后缀00-04"),s(`
`),n("span",{class:"token annotation punctuation"},"@Component"),s(`
`),n("span",{class:"token keyword"},"public"),s(),n("span",{class:"token keyword"},"class"),s(),n("span",{class:"token class-name"},"OrderShardingInitializer"),s(),n("span",{class:"token keyword"},"extends"),s(),n("span",{class:"token class-name"},"AbstractShardingTableModInitializer"),n("span",{class:"token generics"},[n("span",{class:"token punctuation"},"<"),n("span",{class:"token class-name"},"OrderEntity"),n("span",{class:"token punctuation"},">")]),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token doc-comment comment"},[s(`/**
     * 设置模几我们模5就设置5
     * `),n("span",{class:"token keyword"},"@return"),s(`
     */`)]),s(`
    `),n("span",{class:"token annotation punctuation"},"@Override"),s(`
    `),n("span",{class:"token keyword"},"protected"),s(),n("span",{class:"token keyword"},"int"),s(),n("span",{class:"token function"},"mod"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token number"},"5"),n("span",{class:"token punctuation"},";"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`

    `),n("span",{class:"token doc-comment comment"},[s(`/**
     * 编写模5后的尾巴长度默认我们设置2就是左补0
     * `),n("span",{class:"token keyword"},"@return"),s(`
     */`)]),s(`
    `),n("span",{class:"token annotation punctuation"},"@Override"),s(`
    `),n("span",{class:"token keyword"},"protected"),s(),n("span",{class:"token keyword"},"int"),s(),n("span",{class:"token function"},"tailLength"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token number"},"2"),n("span",{class:"token punctuation"},";"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

`),n("span",{class:"token comment"},"//分片的路由,路由使用默认封装的取模配置模数和后缀长度"),s(`
`),n("span",{class:"token annotation punctuation"},"@Component"),s(`
`),n("span",{class:"token keyword"},"public"),s(),n("span",{class:"token keyword"},"class"),s(),n("span",{class:"token class-name"},"OrderTableRoute"),s(),n("span",{class:"token keyword"},"extends"),s(),n("span",{class:"token class-name"},"AbstractModTableRoute"),n("span",{class:"token generics"},[n("span",{class:"token punctuation"},"<"),n("span",{class:"token class-name"},"OrderEntity"),n("span",{class:"token punctuation"},">")]),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token annotation punctuation"},"@Override"),s(`
    `),n("span",{class:"token keyword"},"protected"),s(),n("span",{class:"token keyword"},"int"),s(),n("span",{class:"token function"},"mod"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token number"},"5"),n("span",{class:"token punctuation"},";"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`

    `),n("span",{class:"token annotation punctuation"},"@Override"),s(`
    `),n("span",{class:"token keyword"},"protected"),s(),n("span",{class:"token keyword"},"int"),s(),n("span",{class:"token function"},"tailLength"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token number"},"2"),n("span",{class:"token punctuation"},";"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),b=n("div",{class:"language-sql line-numbers-mode","data-ext":"sql"},[n("pre",{class:"language-sql"},[n("code",null,[s(`
`),n("span",{class:"token keyword"},"CREATE"),s(),n("span",{class:"token keyword"},"DATABASE"),s(),n("span",{class:"token keyword"},"IF"),s(),n("span",{class:"token operator"},"NOT"),s(),n("span",{class:"token keyword"},"EXISTS"),s(" easy_sample "),n("span",{class:"token keyword"},"CHARACTER"),s(),n("span",{class:"token keyword"},"SET"),s(),n("span",{class:"token string"},"'utf8mb4'"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token keyword"},"USE"),s(" easy_sample"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token keyword"},"create"),s(),n("span",{class:"token keyword"},"table"),s(` order_00
`),n("span",{class:"token punctuation"},"("),s(`
    id `),n("span",{class:"token keyword"},"varchar"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"32"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"not"),s(),n("span",{class:"token boolean"},"null"),s(),n("span",{class:"token keyword"},"comment"),s(),n("span",{class:"token string"},"'主键ID'"),n("span",{class:"token keyword"},"primary"),s(),n("span",{class:"token keyword"},"key"),n("span",{class:"token punctuation"},","),s(`
    uid `),n("span",{class:"token keyword"},"varchar"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"50"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"not"),s(),n("span",{class:"token boolean"},"null"),s(),n("span",{class:"token keyword"},"comment"),s(),n("span",{class:"token string"},"'用户id'"),n("span",{class:"token punctuation"},","),s(`
    order_no `),n("span",{class:"token keyword"},"int"),s(),n("span",{class:"token operator"},"not"),s(),n("span",{class:"token boolean"},"null"),s(),n("span",{class:"token keyword"},"comment"),s(),n("span",{class:"token string"},"'订单号'"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token keyword"},"status"),s(),n("span",{class:"token keyword"},"int"),s(),n("span",{class:"token operator"},"not"),s(),n("span",{class:"token boolean"},"null"),s(),n("span",{class:"token keyword"},"comment"),s(),n("span",{class:"token string"},"'订单状态'"),n("span",{class:"token punctuation"},","),s(`
    create_time `),n("span",{class:"token keyword"},"datetime"),s(),n("span",{class:"token operator"},"not"),s(),n("span",{class:"token boolean"},"null"),s(),n("span",{class:"token keyword"},"comment"),s(),n("span",{class:"token string"},"'创建时间'"),s(`
`),n("span",{class:"token punctuation"},")"),n("span",{class:"token keyword"},"comment"),s(),n("span",{class:"token string"},"'订单表'"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token keyword"},"create"),s(),n("span",{class:"token keyword"},"table"),s(` order_01
`),n("span",{class:"token punctuation"},"("),s(`
    id `),n("span",{class:"token keyword"},"varchar"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"32"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"not"),s(),n("span",{class:"token boolean"},"null"),s(),n("span",{class:"token keyword"},"comment"),s(),n("span",{class:"token string"},"'主键ID'"),n("span",{class:"token keyword"},"primary"),s(),n("span",{class:"token keyword"},"key"),n("span",{class:"token punctuation"},","),s(`
    uid `),n("span",{class:"token keyword"},"varchar"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"50"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"not"),s(),n("span",{class:"token boolean"},"null"),s(),n("span",{class:"token keyword"},"comment"),s(),n("span",{class:"token string"},"'用户id'"),n("span",{class:"token punctuation"},","),s(`
    order_no `),n("span",{class:"token keyword"},"int"),s(),n("span",{class:"token operator"},"not"),s(),n("span",{class:"token boolean"},"null"),s(),n("span",{class:"token keyword"},"comment"),s(),n("span",{class:"token string"},"'订单号'"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token keyword"},"status"),s(),n("span",{class:"token keyword"},"int"),s(),n("span",{class:"token operator"},"not"),s(),n("span",{class:"token boolean"},"null"),s(),n("span",{class:"token keyword"},"comment"),s(),n("span",{class:"token string"},"'订单状态'"),n("span",{class:"token punctuation"},","),s(`
    create_time `),n("span",{class:"token keyword"},"datetime"),s(),n("span",{class:"token operator"},"not"),s(),n("span",{class:"token boolean"},"null"),s(),n("span",{class:"token keyword"},"comment"),s(),n("span",{class:"token string"},"'创建时间'"),s(`
`),n("span",{class:"token punctuation"},")"),n("span",{class:"token keyword"},"comment"),s(),n("span",{class:"token string"},"'订单表'"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token keyword"},"create"),s(),n("span",{class:"token keyword"},"table"),s(` order_02
`),n("span",{class:"token punctuation"},"("),s(`
    id `),n("span",{class:"token keyword"},"varchar"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"32"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"not"),s(),n("span",{class:"token boolean"},"null"),s(),n("span",{class:"token keyword"},"comment"),s(),n("span",{class:"token string"},"'主键ID'"),n("span",{class:"token keyword"},"primary"),s(),n("span",{class:"token keyword"},"key"),n("span",{class:"token punctuation"},","),s(`
    uid `),n("span",{class:"token keyword"},"varchar"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"50"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"not"),s(),n("span",{class:"token boolean"},"null"),s(),n("span",{class:"token keyword"},"comment"),s(),n("span",{class:"token string"},"'用户id'"),n("span",{class:"token punctuation"},","),s(`
    order_no `),n("span",{class:"token keyword"},"int"),s(),n("span",{class:"token operator"},"not"),s(),n("span",{class:"token boolean"},"null"),s(),n("span",{class:"token keyword"},"comment"),s(),n("span",{class:"token string"},"'订单号'"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token keyword"},"status"),s(),n("span",{class:"token keyword"},"int"),s(),n("span",{class:"token operator"},"not"),s(),n("span",{class:"token boolean"},"null"),s(),n("span",{class:"token keyword"},"comment"),s(),n("span",{class:"token string"},"'订单状态'"),n("span",{class:"token punctuation"},","),s(`
    create_time `),n("span",{class:"token keyword"},"datetime"),s(),n("span",{class:"token operator"},"not"),s(),n("span",{class:"token boolean"},"null"),s(),n("span",{class:"token keyword"},"comment"),s(),n("span",{class:"token string"},"'创建时间'"),s(`
`),n("span",{class:"token punctuation"},")"),n("span",{class:"token keyword"},"comment"),s(),n("span",{class:"token string"},"'订单表'"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token keyword"},"create"),s(),n("span",{class:"token keyword"},"table"),s(` order_03
`),n("span",{class:"token punctuation"},"("),s(`
    id `),n("span",{class:"token keyword"},"varchar"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"32"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"not"),s(),n("span",{class:"token boolean"},"null"),s(),n("span",{class:"token keyword"},"comment"),s(),n("span",{class:"token string"},"'主键ID'"),n("span",{class:"token keyword"},"primary"),s(),n("span",{class:"token keyword"},"key"),n("span",{class:"token punctuation"},","),s(`
    uid `),n("span",{class:"token keyword"},"varchar"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"50"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"not"),s(),n("span",{class:"token boolean"},"null"),s(),n("span",{class:"token keyword"},"comment"),s(),n("span",{class:"token string"},"'用户id'"),n("span",{class:"token punctuation"},","),s(`
    order_no `),n("span",{class:"token keyword"},"int"),s(),n("span",{class:"token operator"},"not"),s(),n("span",{class:"token boolean"},"null"),s(),n("span",{class:"token keyword"},"comment"),s(),n("span",{class:"token string"},"'订单号'"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token keyword"},"status"),s(),n("span",{class:"token keyword"},"int"),s(),n("span",{class:"token operator"},"not"),s(),n("span",{class:"token boolean"},"null"),s(),n("span",{class:"token keyword"},"comment"),s(),n("span",{class:"token string"},"'订单状态'"),n("span",{class:"token punctuation"},","),s(`
    create_time `),n("span",{class:"token keyword"},"datetime"),s(),n("span",{class:"token operator"},"not"),s(),n("span",{class:"token boolean"},"null"),s(),n("span",{class:"token keyword"},"comment"),s(),n("span",{class:"token string"},"'创建时间'"),s(`
`),n("span",{class:"token punctuation"},")"),n("span",{class:"token keyword"},"comment"),s(),n("span",{class:"token string"},"'订单表'"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token keyword"},"create"),s(),n("span",{class:"token keyword"},"table"),s(` order_04
`),n("span",{class:"token punctuation"},"("),s(`
    id `),n("span",{class:"token keyword"},"varchar"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"32"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"not"),s(),n("span",{class:"token boolean"},"null"),s(),n("span",{class:"token keyword"},"comment"),s(),n("span",{class:"token string"},"'主键ID'"),n("span",{class:"token keyword"},"primary"),s(),n("span",{class:"token keyword"},"key"),n("span",{class:"token punctuation"},","),s(`
    uid `),n("span",{class:"token keyword"},"varchar"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"50"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"not"),s(),n("span",{class:"token boolean"},"null"),s(),n("span",{class:"token keyword"},"comment"),s(),n("span",{class:"token string"},"'用户id'"),n("span",{class:"token punctuation"},","),s(`
    order_no `),n("span",{class:"token keyword"},"int"),s(),n("span",{class:"token operator"},"not"),s(),n("span",{class:"token boolean"},"null"),s(),n("span",{class:"token keyword"},"comment"),s(),n("span",{class:"token string"},"'订单号'"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token keyword"},"status"),s(),n("span",{class:"token keyword"},"int"),s(),n("span",{class:"token operator"},"not"),s(),n("span",{class:"token boolean"},"null"),s(),n("span",{class:"token keyword"},"comment"),s(),n("span",{class:"token string"},"'订单状态'"),n("span",{class:"token punctuation"},","),s(`
    create_time `),n("span",{class:"token keyword"},"datetime"),s(),n("span",{class:"token operator"},"not"),s(),n("span",{class:"token boolean"},"null"),s(),n("span",{class:"token keyword"},"comment"),s(),n("span",{class:"token string"},"'创建时间'"),s(`
`),n("span",{class:"token punctuation"},")"),n("span",{class:"token keyword"},"comment"),s(),n("span",{class:"token string"},"'订单表'"),n("span",{class:"token punctuation"},";"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),v=o('<h2 id="配置文件" tabindex="-1"><a class="header-anchor" href="#配置文件" aria-hidden="true">#</a> 配置文件</h2><p>因为分片涉及到跨表聚合所以需要设置默认数据源的连接池大小，并且设置分片可用数据源大小</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code>\n<span class="token key atrule">server</span><span class="token punctuation">:</span>\n  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8081</span>\n\n<span class="token key atrule">spring</span><span class="token punctuation">:</span>\n\n  <span class="token key atrule">datasource</span><span class="token punctuation">:</span>\n    <span class="token key atrule">type</span><span class="token punctuation">:</span> com.alibaba.druid.pool.DruidDataSource\n    <span class="token key atrule">driver-class-name</span><span class="token punctuation">:</span> com.mysql.cj.jdbc.Driver\n    <span class="token key atrule">url</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>mysql<span class="token punctuation">:</span>//127.0.0.1<span class="token punctuation">:</span>3306/easy_sample<span class="token punctuation">?</span>serverTimezone=GMT%2B8<span class="token important">&amp;characterEncoding=utf-8&amp;useSSL=false&amp;allowMultiQueries=true&amp;rewriteBatchedStatements=true</span>\n    <span class="token key atrule">username</span><span class="token punctuation">:</span> root\n    <span class="token key atrule">password</span><span class="token punctuation">:</span> root\n    <span class="token key atrule">druid</span><span class="token punctuation">:</span>\n      <span class="token key atrule">initial-size</span><span class="token punctuation">:</span> <span class="token number">10</span>\n      <span class="token key atrule">max-active</span><span class="token punctuation">:</span> <span class="token number">100</span>\n\n<span class="token key atrule">easy-query</span><span class="token punctuation">:</span>\n  <span class="token key atrule">enable</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>\n  <span class="token key atrule">name-conversion</span><span class="token punctuation">:</span> underlined\n  <span class="token key atrule">database</span><span class="token punctuation">:</span> mysql\n  <span class="token key atrule">defaultDataSourceMergePoolSize</span><span class="token punctuation">:</span> <span class="token number">50</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>我们设置了最大连接数100,分片可用连接池数50</p><h2 id="新增" tabindex="-1"><a class="header-anchor" href="#新增" aria-hidden="true">#</a> 新增</h2><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>\n<span class="token annotation punctuation">@RestController</span>\n<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/orderShardingTable&quot;</span><span class="token punctuation">)</span>\n<span class="token annotation punctuation">@RequiredArgsConstructor</span><span class="token punctuation">(</span>onConstructor_ <span class="token operator">=</span> <span class="token annotation punctuation">@Autowired</span><span class="token punctuation">)</span>\n<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OrderShardingTableController</span> <span class="token punctuation">{</span>\n    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">EasyQuery</span> easyQuery<span class="token punctuation">;</span>\n\n    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/add&quot;</span><span class="token punctuation">)</span>\n    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">OrderEntity</span><span class="token punctuation">&gt;</span></span> orderEntities <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> users <span class="token operator">=</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span><span class="token string">&quot;xiaoming&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;xiaohong&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;xiaolan&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n            <span class="token class-name">OrderEntity</span> orderEntity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">OrderEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n            orderEntity<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n            <span class="token keyword">int</span> i1 <span class="token operator">=</span> i <span class="token operator">%</span> <span class="token number">3</span><span class="token punctuation">;</span>\n            <span class="token class-name">String</span> uid <span class="token operator">=</span> users<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i1<span class="token punctuation">)</span><span class="token punctuation">;</span>\n            orderEntity<span class="token punctuation">.</span><span class="token function">setUid</span><span class="token punctuation">(</span>uid<span class="token punctuation">)</span><span class="token punctuation">;</span>\n            orderEntity<span class="token punctuation">.</span><span class="token function">setOrderNo</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>\n            orderEntity<span class="token punctuation">.</span><span class="token function">setStatus</span><span class="token punctuation">(</span>i1<span class="token punctuation">)</span><span class="token punctuation">;</span>\n            orderEntity<span class="token punctuation">.</span><span class="token function">setCreateTime</span><span class="token punctuation">(</span><span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n            orderEntities<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>orderEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n        <span class="token keyword">long</span> l <span class="token operator">=</span> easyQuery<span class="token punctuation">.</span><span class="token function">insertable</span><span class="token punctuation">(</span>orderEntities<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">executeRows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token keyword">return</span> <span class="token string">&quot;成功插入:&quot;</span><span class="token operator">+</span>l<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-log line-numbers-mode" data-ext="log"><pre class="language-log"><code> <span class="token operator">:</span> <span class="token operator">=</span><span class="token operator">=</span><span class="token operator">&gt;</span> http<span class="token operator">-</span>nio<span class="token operator">-</span><span class="token number">8081</span><span class="token operator">-</span>exec<span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">,</span> name<span class="token operator">:</span>ds0<span class="token punctuation">,</span> Preparing<span class="token operator">:</span> INSERT INTO `order_03` <span class="token operator">(</span>`id`<span class="token punctuation">,</span>`uid`<span class="token punctuation">,</span>`order_no`<span class="token punctuation">,</span>`status`<span class="token punctuation">,</span>`create_time`<span class="token operator">)</span> VALUES <span class="token operator">(</span><span class="token operator">?</span><span class="token punctuation">,</span><span class="token operator">?</span><span class="token punctuation">,</span><span class="token operator">?</span><span class="token punctuation">,</span><span class="token operator">?</span><span class="token punctuation">,</span><span class="token operator">?</span><span class="token operator">)</span>\n <span class="token operator">:</span> <span class="token operator">=</span><span class="token operator">=</span><span class="token operator">&gt;</span> http<span class="token operator">-</span>nio<span class="token operator">-</span><span class="token number">8081</span><span class="token operator">-</span>exec<span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">,</span> name<span class="token operator">:</span>ds0<span class="token punctuation">,</span> Parameters<span class="token operator">:</span> <span class="token number">0</span><span class="token operator">(</span>String<span class="token operator">)</span><span class="token punctuation">,</span>xiaoming<span class="token operator">(</span>String<span class="token operator">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token operator">(</span>Integer<span class="token operator">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token operator">(</span>Integer<span class="token operator">)</span><span class="token punctuation">,</span><span class="token date number">2023-09-02T</span><span class="token time number">15:15:29.391349</span><span class="token operator">(</span>LocalDateTime<span class="token operator">)</span>\n <span class="token operator">:</span> <span class="token operator">&lt;</span><span class="token operator">=</span><span class="token operator">=</span> http<span class="token operator">-</span>nio<span class="token operator">-</span><span class="token number">8081</span><span class="token operator">-</span>exec<span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">,</span> name<span class="token operator">:</span>ds0<span class="token punctuation">,</span> Total<span class="token operator">:</span> <span class="token number">1</span>\n <span class="token operator">:</span> <span class="token operator">=</span><span class="token operator">=</span><span class="token operator">&gt;</span> http<span class="token operator">-</span>nio<span class="token operator">-</span><span class="token number">8081</span><span class="token operator">-</span>exec<span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">,</span> name<span class="token operator">:</span>ds0<span class="token punctuation">,</span> Preparing<span class="token operator">:</span> INSERT INTO `order_04` <span class="token operator">(</span>`id`<span class="token punctuation">,</span>`uid`<span class="token punctuation">,</span>`order_no`<span class="token punctuation">,</span>`status`<span class="token punctuation">,</span>`create_time`<span class="token operator">)</span> VALUES <span class="token operator">(</span><span class="token operator">?</span><span class="token punctuation">,</span><span class="token operator">?</span><span class="token punctuation">,</span><span class="token operator">?</span><span class="token punctuation">,</span><span class="token operator">?</span><span class="token punctuation">,</span><span class="token operator">?</span><span class="token operator">)</span>\n <span class="token operator">:</span> <span class="token operator">=</span><span class="token operator">=</span><span class="token operator">&gt;</span> http<span class="token operator">-</span>nio<span class="token operator">-</span><span class="token number">8081</span><span class="token operator">-</span>exec<span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">,</span> name<span class="token operator">:</span>ds0<span class="token punctuation">,</span> Parameters<span class="token operator">:</span> <span class="token number">1</span><span class="token operator">(</span>String<span class="token operator">)</span><span class="token punctuation">,</span>xiaohong<span class="token operator">(</span>String<span class="token operator">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">(</span>Integer<span class="token operator">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">(</span>Integer<span class="token operator">)</span><span class="token punctuation">,</span><span class="token date number">2023-09-02T</span><span class="token time number">15:15:29.391420</span><span class="token operator">(</span>LocalDateTime<span class="token operator">)</span>\n <span class="token operator">:</span> <span class="token operator">&lt;</span><span class="token operator">=</span><span class="token operator">=</span> http<span class="token operator">-</span>nio<span class="token operator">-</span><span class="token number">8081</span><span class="token operator">-</span>exec<span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">,</span> name<span class="token operator">:</span>ds0<span class="token punctuation">,</span> Total<span class="token operator">:</span> <span class="token number">1</span>\n <span class="token operator">:</span> <span class="token operator">=</span><span class="token operator">=</span><span class="token operator">&gt;</span> http<span class="token operator">-</span>nio<span class="token operator">-</span><span class="token number">8081</span><span class="token operator">-</span>exec<span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">,</span> name<span class="token operator">:</span>ds0<span class="token punctuation">,</span> Preparing<span class="token operator">:</span> INSERT INTO `order_00` <span class="token operator">(</span>`id`<span class="token punctuation">,</span>`uid`<span class="token punctuation">,</span>`order_no`<span class="token punctuation">,</span>`status`<span class="token punctuation">,</span>`create_time`<span class="token operator">)</span> VALUES <span class="token operator">(</span><span class="token operator">?</span><span class="token punctuation">,</span><span class="token operator">?</span><span class="token punctuation">,</span><span class="token operator">?</span><span class="token punctuation">,</span><span class="token operator">?</span><span class="token punctuation">,</span><span class="token operator">?</span><span class="token operator">)</span>\n <span class="token operator">:</span> <span class="token operator">=</span><span class="token operator">=</span><span class="token operator">&gt;</span> http<span class="token operator">-</span>nio<span class="token operator">-</span><span class="token number">8081</span><span class="token operator">-</span>exec<span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">,</span> name<span class="token operator">:</span>ds0<span class="token punctuation">,</span> Parameters<span class="token operator">:</span> <span class="token number">2</span><span class="token operator">(</span>String<span class="token operator">)</span><span class="token punctuation">,</span>xiaolan<span class="token operator">(</span>String<span class="token operator">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token operator">(</span>Integer<span class="token operator">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token operator">(</span>Integer<span class="token operator">)</span><span class="token punctuation">,</span><span class="token date number">2023-09-02T</span><span class="token time number">15:15:29.391433</span><span class="token operator">(</span>LocalDateTime<span class="token operator">)</span>\n <span class="token operator">:</span> <span class="token operator">&lt;</span><span class="token operator">=</span><span class="token operator">=</span> http<span class="token operator">-</span>nio<span class="token operator">-</span><span class="token number">8081</span><span class="token operator">-</span>exec<span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">,</span> name<span class="token operator">:</span>ds0<span class="token punctuation">,</span> Total<span class="token operator">:</span> <span class="token number">1</span>\n <span class="token operator">:</span> <span class="token operator">=</span><span class="token operator">=</span><span class="token operator">&gt;</span> http<span class="token operator">-</span>nio<span class="token operator">-</span><span class="token number">8081</span><span class="token operator">-</span>exec<span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">,</span> name<span class="token operator">:</span>ds0<span class="token punctuation">,</span> Preparing<span class="token operator">:</span> INSERT INTO `order_01` <span class="token operator">(</span>`id`<span class="token punctuation">,</span>`uid`<span class="token punctuation">,</span>`order_no`<span class="token punctuation">,</span>`status`<span class="token punctuation">,</span>`create_time`<span class="token operator">)</span> VALUES <span class="token operator">(</span><span class="token operator">?</span><span class="token punctuation">,</span><span class="token operator">?</span><span class="token punctuation">,</span><span class="token operator">?</span><span class="token punctuation">,</span><span class="token operator">?</span><span class="token punctuation">,</span><span class="token operator">?</span><span class="token operator">)</span>\n <span class="token operator">:</span> <span class="token operator">=</span><span class="token operator">=</span><span class="token operator">&gt;</span> http<span class="token operator">-</span>nio<span class="token operator">-</span><span class="token number">8081</span><span class="token operator">-</span>exec<span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">,</span> name<span class="token operator">:</span>ds0<span class="token punctuation">,</span> Parameters<span class="token operator">:</span> <span class="token number">3</span><span class="token operator">(</span>String<span class="token operator">)</span><span class="token punctuation">,</span>xiaoming<span class="token operator">(</span>String<span class="token operator">)</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token operator">(</span>Integer<span class="token operator">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token operator">(</span>Integer<span class="token operator">)</span><span class="token punctuation">,</span><span class="token date number">2023-09-02T</span><span class="token time number">15:15:29.391445</span><span class="token operator">(</span>LocalDateTime<span class="token operator">)</span>\n <span class="token operator">:</span> <span class="token operator">&lt;</span><span class="token operator">=</span><span class="token operator">=</span> http<span class="token operator">-</span>nio<span class="token operator">-</span><span class="token number">8081</span><span class="token operator">-</span>exec<span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">,</span> name<span class="token operator">:</span>ds0<span class="token punctuation">,</span> Total<span class="token operator">:</span> <span class="token number">1</span>\n <span class="token operator">:</span> <span class="token operator">=</span><span class="token operator">=</span><span class="token operator">&gt;</span> http<span class="token operator">-</span>nio<span class="token operator">-</span><span class="token number">8081</span><span class="token operator">-</span>exec<span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">,</span> name<span class="token operator">:</span>ds0<span class="token punctuation">,</span> Preparing<span class="token operator">:</span> INSERT INTO `order_02` <span class="token operator">(</span>`id`<span class="token punctuation">,</span>`uid`<span class="token punctuation">,</span>`order_no`<span class="token punctuation">,</span>`status`<span class="token punctuation">,</span>`create_time`<span class="token operator">)</span> VALUES <span class="token operator">(</span><span class="token operator">?</span><span class="token punctuation">,</span><span class="token operator">?</span><span class="token punctuation">,</span><span class="token operator">?</span><span class="token punctuation">,</span><span class="token operator">?</span><span class="token punctuation">,</span><span class="token operator">?</span><span class="token operator">)</span>\n <span class="token operator">:</span> <span class="token operator">=</span><span class="token operator">=</span><span class="token operator">&gt;</span> http<span class="token operator">-</span>nio<span class="token operator">-</span><span class="token number">8081</span><span class="token operator">-</span>exec<span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">,</span> name<span class="token operator">:</span>ds0<span class="token punctuation">,</span> Parameters<span class="token operator">:</span> <span class="token number">4</span><span class="token operator">(</span>String<span class="token operator">)</span><span class="token punctuation">,</span>xiaohong<span class="token operator">(</span>String<span class="token operator">)</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token operator">(</span>Integer<span class="token operator">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">(</span>Integer<span class="token operator">)</span><span class="token punctuation">,</span><span class="token date number">2023-09-02T</span><span class="token time number">15:15:29.391457</span><span class="token operator">(</span>LocalDateTime<span class="token operator">)</span>\n <span class="token operator">:</span> <span class="token operator">&lt;</span><span class="token operator">=</span><span class="token operator">=</span> http<span class="token operator">-</span>nio<span class="token operator">-</span><span class="token number">8081</span><span class="token operator">-</span>exec<span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">,</span> name<span class="token operator">:</span>ds0<span class="token punctuation">,</span> Total<span class="token operator">:</span> <span class="token number">1</span>\n <span class="token operator">:</span> <span class="token operator">=</span><span class="token operator">=</span><span class="token operator">&gt;</span> http<span class="token operator">-</span>nio<span class="token operator">-</span><span class="token number">8081</span><span class="token operator">-</span>exec<span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">,</span> name<span class="token operator">:</span>ds0<span class="token punctuation">,</span> Preparing<span class="token operator">:</span> INSERT INTO `order_03` <span class="token operator">(</span>`id`<span class="token punctuation">,</span>`uid`<span class="token punctuation">,</span>`order_no`<span class="token punctuation">,</span>`status`<span class="token punctuation">,</span>`create_time`<span class="token operator">)</span> VALUES <span class="token operator">(</span><span class="token operator">?</span><span class="token punctuation">,</span><span class="token operator">?</span><span class="token punctuation">,</span><span class="token operator">?</span><span class="token punctuation">,</span><span class="token operator">?</span><span class="token punctuation">,</span><span class="token operator">?</span><span class="token operator">)</span>\n <span class="token operator">:</span> <span class="token operator">=</span><span class="token operator">=</span><span class="token operator">&gt;</span> http<span class="token operator">-</span>nio<span class="token operator">-</span><span class="token number">8081</span><span class="token operator">-</span>exec<span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">,</span> name<span class="token operator">:</span>ds0<span class="token punctuation">,</span> Parameters<span class="token operator">:</span> <span class="token number">5</span><span class="token operator">(</span>String<span class="token operator">)</span><span class="token punctuation">,</span>xiaolan<span class="token operator">(</span>String<span class="token operator">)</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token operator">(</span>Integer<span class="token operator">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token operator">(</span>Integer<span class="token operator">)</span><span class="token punctuation">,</span><span class="token date number">2023-09-02T</span><span class="token time number">15:15:29.391469</span><span class="token operator">(</span>LocalDateTime<span class="token operator">)</span>\n <span class="token operator">:</span> <span class="token operator">&lt;</span><span class="token operator">=</span><span class="token operator">=</span> http<span class="token operator">-</span>nio<span class="token operator">-</span><span class="token number">8081</span><span class="token operator">-</span>exec<span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">,</span> name<span class="token operator">:</span>ds0<span class="token punctuation">,</span> Total<span class="token operator">:</span> <span class="token number">1</span>\n <span class="token operator">:</span> <span class="token operator">=</span><span class="token operator">=</span><span class="token operator">&gt;</span> http<span class="token operator">-</span>nio<span class="token operator">-</span><span class="token number">8081</span><span class="token operator">-</span>exec<span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">,</span> name<span class="token operator">:</span>ds0<span class="token punctuation">,</span> Preparing<span class="token operator">:</span> INSERT INTO `order_04` <span class="token operator">(</span>`id`<span class="token punctuation">,</span>`uid`<span class="token punctuation">,</span>`order_no`<span class="token punctuation">,</span>`status`<span class="token punctuation">,</span>`create_time`<span class="token operator">)</span> VALUES <span class="token operator">(</span><span class="token operator">?</span><span class="token punctuation">,</span><span class="token operator">?</span><span class="token punctuation">,</span><span class="token operator">?</span><span class="token punctuation">,</span><span class="token operator">?</span><span class="token punctuation">,</span><span class="token operator">?</span><span class="token operator">)</span>\n <span class="token operator">:</span> <span class="token operator">=</span><span class="token operator">=</span><span class="token operator">&gt;</span> http<span class="token operator">-</span>nio<span class="token operator">-</span><span class="token number">8081</span><span class="token operator">-</span>exec<span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">,</span> name<span class="token operator">:</span>ds0<span class="token punctuation">,</span> Parameters<span class="token operator">:</span> <span class="token number">6</span><span class="token operator">(</span>String<span class="token operator">)</span><span class="token punctuation">,</span>xiaoming<span class="token operator">(</span>String<span class="token operator">)</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token operator">(</span>Integer<span class="token operator">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token operator">(</span>Integer<span class="token operator">)</span><span class="token punctuation">,</span><span class="token date number">2023-09-02T</span><span class="token time number">15:15:29.391481</span><span class="token operator">(</span>LocalDateTime<span class="token operator">)</span>\n <span class="token operator">:</span> <span class="token operator">&lt;</span><span class="token operator">=</span><span class="token operator">=</span> http<span class="token operator">-</span>nio<span class="token operator">-</span><span class="token number">8081</span><span class="token operator">-</span>exec<span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">,</span> name<span class="token operator">:</span>ds0<span class="token punctuation">,</span> Total<span class="token operator">:</span> <span class="token number">1</span>\n <span class="token operator">:</span> <span class="token operator">=</span><span class="token operator">=</span><span class="token operator">&gt;</span> http<span class="token operator">-</span>nio<span class="token operator">-</span><span class="token number">8081</span><span class="token operator">-</span>exec<span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">,</span> name<span class="token operator">:</span>ds0<span class="token punctuation">,</span> Preparing<span class="token operator">:</span> INSERT INTO `order_00` <span class="token operator">(</span>`id`<span class="token punctuation">,</span>`uid`<span class="token punctuation">,</span>`order_no`<span class="token punctuation">,</span>`status`<span class="token punctuation">,</span>`create_time`<span class="token operator">)</span> VALUES <span class="token operator">(</span><span class="token operator">?</span><span class="token punctuation">,</span><span class="token operator">?</span><span class="token punctuation">,</span><span class="token operator">?</span><span class="token punctuation">,</span><span class="token operator">?</span><span class="token punctuation">,</span><span class="token operator">?</span><span class="token operator">)</span>\n <span class="token operator">:</span> <span class="token operator">=</span><span class="token operator">=</span><span class="token operator">&gt;</span> http<span class="token operator">-</span>nio<span class="token operator">-</span><span class="token number">8081</span><span class="token operator">-</span>exec<span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">,</span> name<span class="token operator">:</span>ds0<span class="token punctuation">,</span> Parameters<span class="token operator">:</span> <span class="token number">7</span><span class="token operator">(</span>String<span class="token operator">)</span><span class="token punctuation">,</span>xiaohong<span class="token operator">(</span>String<span class="token operator">)</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token operator">(</span>Integer<span class="token operator">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">(</span>Integer<span class="token operator">)</span><span class="token punctuation">,</span><span class="token date number">2023-09-02T</span><span class="token time number">15:15:29.391492</span><span class="token operator">(</span>LocalDateTime<span class="token operator">)</span>\n <span class="token operator">:</span> <span class="token operator">&lt;</span><span class="token operator">=</span><span class="token operator">=</span> http<span class="token operator">-</span>nio<span class="token operator">-</span><span class="token number">8081</span><span class="token operator">-</span>exec<span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">,</span> name<span class="token operator">:</span>ds0<span class="token punctuation">,</span> Total<span class="token operator">:</span> <span class="token number">1</span>\n <span class="token operator">:</span> <span class="token operator">=</span><span class="token operator">=</span><span class="token operator">&gt;</span> http<span class="token operator">-</span>nio<span class="token operator">-</span><span class="token number">8081</span><span class="token operator">-</span>exec<span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">,</span> name<span class="token operator">:</span>ds0<span class="token punctuation">,</span> Preparing<span class="token operator">:</span> INSERT INTO `order_01` <span class="token operator">(</span>`id`<span class="token punctuation">,</span>`uid`<span class="token punctuation">,</span>`order_no`<span class="token punctuation">,</span>`status`<span class="token punctuation">,</span>`create_time`<span class="token operator">)</span> VALUES <span class="token operator">(</span><span class="token operator">?</span><span class="token punctuation">,</span><span class="token operator">?</span><span class="token punctuation">,</span><span class="token operator">?</span><span class="token punctuation">,</span><span class="token operator">?</span><span class="token punctuation">,</span><span class="token operator">?</span><span class="token operator">)</span>\n <span class="token operator">:</span> <span class="token operator">=</span><span class="token operator">=</span><span class="token operator">&gt;</span> http<span class="token operator">-</span>nio<span class="token operator">-</span><span class="token number">8081</span><span class="token operator">-</span>exec<span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">,</span> name<span class="token operator">:</span>ds0<span class="token punctuation">,</span> Parameters<span class="token operator">:</span> <span class="token number">8</span><span class="token operator">(</span>String<span class="token operator">)</span><span class="token punctuation">,</span>xiaolan<span class="token operator">(</span>String<span class="token operator">)</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token operator">(</span>Integer<span class="token operator">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token operator">(</span>Integer<span class="token operator">)</span><span class="token punctuation">,</span><span class="token date number">2023-09-02T</span><span class="token time number">15:15:29.391504</span><span class="token operator">(</span>LocalDateTime<span class="token operator">)</span>\n <span class="token operator">:</span> <span class="token operator">&lt;</span><span class="token operator">=</span><span class="token operator">=</span> http<span class="token operator">-</span>nio<span class="token operator">-</span><span class="token number">8081</span><span class="token operator">-</span>exec<span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">,</span> name<span class="token operator">:</span>ds0<span class="token punctuation">,</span> Total<span class="token operator">:</span> <span class="token number">1</span>\n <span class="token operator">:</span> <span class="token operator">=</span><span class="token operator">=</span><span class="token operator">&gt;</span> http<span class="token operator">-</span>nio<span class="token operator">-</span><span class="token number">8081</span><span class="token operator">-</span>exec<span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">,</span> name<span class="token operator">:</span>ds0<span class="token punctuation">,</span> Preparing<span class="token operator">:</span> INSERT INTO `order_02` <span class="token operator">(</span>`id`<span class="token punctuation">,</span>`uid`<span class="token punctuation">,</span>`order_no`<span class="token punctuation">,</span>`status`<span class="token punctuation">,</span>`create_time`<span class="token operator">)</span> VALUES <span class="token operator">(</span><span class="token operator">?</span><span class="token punctuation">,</span><span class="token operator">?</span><span class="token punctuation">,</span><span class="token operator">?</span><span class="token punctuation">,</span><span class="token operator">?</span><span class="token punctuation">,</span><span class="token operator">?</span><span class="token operator">)</span>\n <span class="token operator">:</span> <span class="token operator">=</span><span class="token operator">=</span><span class="token operator">&gt;</span> http<span class="token operator">-</span>nio<span class="token operator">-</span><span class="token number">8081</span><span class="token operator">-</span>exec<span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">,</span> name<span class="token operator">:</span>ds0<span class="token punctuation">,</span> Parameters<span class="token operator">:</span> <span class="token number">9</span><span class="token operator">(</span>String<span class="token operator">)</span><span class="token punctuation">,</span>xiaoming<span class="token operator">(</span>String<span class="token operator">)</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token operator">(</span>Integer<span class="token operator">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token operator">(</span>Integer<span class="token operator">)</span><span class="token punctuation">,</span><span class="token date number">2023-09-02T</span><span class="token time number">15:15:29.391516</span><span class="token operator">(</span>LocalDateTime<span class="token operator">)</span>\n <span class="token operator">:</span> <span class="token operator">&lt;</span><span class="token operator">=</span><span class="token operator">=</span> http<span class="token operator">-</span>nio<span class="token operator">-</span><span class="token number">8081</span><span class="token operator">-</span>exec<span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">,</span> name<span class="token operator">:</span>ds0<span class="token punctuation">,</span> Total<span class="token operator">:</span> <span class="token number">1</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="修改" tabindex="-1"><a class="header-anchor" href="#修改" aria-hidden="true">#</a> 修改</h2><p>进修改时间所以只会变更时间</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/edit&quot;</span><span class="token punctuation">)</span>\n<span class="token annotation punctuation">@EasyQueryTrack</span>\n<span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">edit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token class-name">OrderEntity</span> orderEntity <span class="token operator">=</span> easyQuery<span class="token punctuation">.</span><span class="token function">queryable</span><span class="token punctuation">(</span><span class="token class-name">OrderEntity</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>\n            <span class="token punctuation">.</span><span class="token function">asTracking</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n            <span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span>o<span class="token operator">-&gt;</span>o<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">OrderEntity</span><span class="token operator">::</span><span class="token function">getId</span><span class="token punctuation">,</span><span class="token string">&quot;1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">firstNotNull</span><span class="token punctuation">(</span><span class="token string">&quot;未找到对应的订单&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    orderEntity<span class="token punctuation">.</span><span class="token function">setCreateTime</span><span class="token punctuation">(</span><span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    easyQuery<span class="token punctuation">.</span><span class="token function">updatable</span><span class="token punctuation">(</span>orderEntity<span class="token punctuation">)</span>\n            <span class="token punctuation">.</span><span class="token function">executeRows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">return</span> orderEntity<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-log line-numbers-mode" data-ext="log"><pre class="language-log"><code><span class="token operator">:</span> <span class="token operator">=</span><span class="token operator">=</span><span class="token operator">&gt;</span> http<span class="token operator">-</span>nio<span class="token operator">-</span><span class="token number">8081</span><span class="token operator">-</span>exec<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> name<span class="token operator">:</span>ds0<span class="token punctuation">,</span> Preparing<span class="token operator">:</span> SELECT `id`<span class="token punctuation">,</span>`uid`<span class="token punctuation">,</span>`order_no`<span class="token punctuation">,</span>`status`<span class="token punctuation">,</span>`create_time` FROM `order_04` WHERE `id` <span class="token operator">=</span> <span class="token operator">?</span> LIMIT <span class="token number">1</span>\n<span class="token operator">:</span> <span class="token operator">=</span><span class="token operator">=</span><span class="token operator">&gt;</span> http<span class="token operator">-</span>nio<span class="token operator">-</span><span class="token number">8081</span><span class="token operator">-</span>exec<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> name<span class="token operator">:</span>ds0<span class="token punctuation">,</span> Parameters<span class="token operator">:</span> <span class="token number">1</span><span class="token operator">(</span>String<span class="token operator">)</span>\n<span class="token operator">:</span> <span class="token operator">&lt;</span><span class="token operator">=</span><span class="token operator">=</span> http<span class="token operator">-</span>nio<span class="token operator">-</span><span class="token number">8081</span><span class="token operator">-</span>exec<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> name<span class="token operator">:</span>ds0<span class="token punctuation">,</span> Time Elapsed<span class="token operator">:</span> <span class="token number">20</span><span class="token operator">(</span>ms<span class="token operator">)</span>\n<span class="token operator">:</span> <span class="token operator">&lt;</span><span class="token operator">=</span><span class="token operator">=</span> Total<span class="token operator">:</span> <span class="token number">1</span>\n<span class="token operator">:</span> <span class="token operator">=</span><span class="token operator">=</span><span class="token operator">&gt;</span> http<span class="token operator">-</span>nio<span class="token operator">-</span><span class="token number">8081</span><span class="token operator">-</span>exec<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> name<span class="token operator">:</span>ds0<span class="token punctuation">,</span> Preparing<span class="token operator">:</span> UPDATE `order_04` SET `create_time` <span class="token operator">=</span> <span class="token operator">?</span> WHERE `id` <span class="token operator">=</span> <span class="token operator">?</span>\n<span class="token operator">:</span> <span class="token operator">=</span><span class="token operator">=</span><span class="token operator">&gt;</span> http<span class="token operator">-</span>nio<span class="token operator">-</span><span class="token number">8081</span><span class="token operator">-</span>exec<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> name<span class="token operator">:</span>ds0<span class="token punctuation">,</span> Parameters<span class="token operator">:</span> <span class="token date number">2023-09-02T</span><span class="token time number">15:20:13.029025</span><span class="token operator">(</span>LocalDateTime<span class="token operator">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">(</span>String<span class="token operator">)</span>\n<span class="token operator">:</span> <span class="token operator">&lt;</span><span class="token operator">=</span><span class="token operator">=</span> http<span class="token operator">-</span>nio<span class="token operator">-</span><span class="token number">8081</span><span class="token operator">-</span>exec<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> name<span class="token operator">:</span>ds0<span class="token punctuation">,</span> Total<span class="token operator">:</span> <span class="token number">1</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>并发更新，将订单状态为2的数据改为3,并且需要支持并发操作</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>\n<span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/concurrentEdit&quot;</span><span class="token punctuation">)</span>\n<span class="token annotation punctuation">@EasyQueryTrack</span>\n<span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">concurrentEdit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token class-name">OrderEntity</span> orderEntity <span class="token operator">=</span> easyQuery<span class="token punctuation">.</span><span class="token function">queryable</span><span class="token punctuation">(</span><span class="token class-name">OrderEntity</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>\n            <span class="token punctuation">.</span><span class="token function">asTracking</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n            <span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span>o<span class="token operator">-&gt;</span>o<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">OrderEntity</span><span class="token operator">::</span><span class="token function">getId</span><span class="token punctuation">,</span><span class="token string">&quot;2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">firstNotNull</span><span class="token punctuation">(</span><span class="token string">&quot;未找到对应的订单&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span>orderEntity<span class="token punctuation">.</span><span class="token function">getStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>\n        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">&quot;订单状态不是2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    orderEntity<span class="token punctuation">.</span><span class="token function">setCreateTime</span><span class="token punctuation">(</span><span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    orderEntity<span class="token punctuation">.</span><span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    easyQuery<span class="token punctuation">.</span><span class="token function">updatable</span><span class="token punctuation">(</span>orderEntity<span class="token punctuation">)</span>\n            <span class="token punctuation">.</span><span class="token function">whereColumns</span><span class="token punctuation">(</span>o<span class="token operator">-&gt;</span>o<span class="token punctuation">.</span><span class="token function">columnKeys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">column</span><span class="token punctuation">(</span><span class="token class-name">OrderEntity</span><span class="token operator">::</span><span class="token function">getStatus</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n            <span class="token punctuation">.</span><span class="token function">executeRows</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">&quot;并发修改失败&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">return</span> orderEntity<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-log line-numbers-mode" data-ext="log"><pre class="language-log"><code>\n<span class="token operator">:</span> <span class="token operator">=</span><span class="token operator">=</span><span class="token operator">&gt;</span> http<span class="token operator">-</span>nio<span class="token operator">-</span><span class="token number">8081</span><span class="token operator">-</span>exec<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> name<span class="token operator">:</span>ds0<span class="token punctuation">,</span> Preparing<span class="token operator">:</span> SELECT `id`<span class="token punctuation">,</span>`uid`<span class="token punctuation">,</span>`order_no`<span class="token punctuation">,</span>`status`<span class="token punctuation">,</span>`create_time` FROM `order_00` WHERE `id` <span class="token operator">=</span> <span class="token operator">?</span> LIMIT <span class="token number">1</span>\n<span class="token operator">:</span> <span class="token operator">=</span><span class="token operator">=</span><span class="token operator">&gt;</span> http<span class="token operator">-</span>nio<span class="token operator">-</span><span class="token number">8081</span><span class="token operator">-</span>exec<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> name<span class="token operator">:</span>ds0<span class="token punctuation">,</span> Parameters<span class="token operator">:</span> <span class="token number">2</span><span class="token operator">(</span>String<span class="token operator">)</span>\n<span class="token operator">:</span> <span class="token operator">&lt;</span><span class="token operator">=</span><span class="token operator">=</span> http<span class="token operator">-</span>nio<span class="token operator">-</span><span class="token number">8081</span><span class="token operator">-</span>exec<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> name<span class="token operator">:</span>ds0<span class="token punctuation">,</span> Time Elapsed<span class="token operator">:</span> <span class="token number">5</span><span class="token operator">(</span>ms<span class="token operator">)</span>\n<span class="token operator">:</span> <span class="token operator">&lt;</span><span class="token operator">=</span><span class="token operator">=</span> Total<span class="token operator">:</span> <span class="token number">1</span>\n<span class="token operator">:</span> <span class="token operator">=</span><span class="token operator">=</span><span class="token operator">&gt;</span> http<span class="token operator">-</span>nio<span class="token operator">-</span><span class="token number">8081</span><span class="token operator">-</span>exec<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> name<span class="token operator">:</span>ds0<span class="token punctuation">,</span> Preparing<span class="token operator">:</span> UPDATE `order_00` SET `status` <span class="token operator">=</span> <span class="token operator">?</span><span class="token punctuation">,</span>`create_time` <span class="token operator">=</span> <span class="token operator">?</span> WHERE `id` <span class="token operator">=</span> <span class="token operator">?</span> AND `status` <span class="token operator">=</span> <span class="token operator">?</span>\n<span class="token operator">:</span> <span class="token operator">=</span><span class="token operator">=</span><span class="token operator">&gt;</span> http<span class="token operator">-</span>nio<span class="token operator">-</span><span class="token number">8081</span><span class="token operator">-</span>exec<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> name<span class="token operator">:</span>ds0<span class="token punctuation">,</span> Parameters<span class="token operator">:</span> <span class="token number">3</span><span class="token operator">(</span>Integer<span class="token operator">)</span><span class="token punctuation">,</span><span class="token date number">2023-09-02T</span><span class="token time number">15:23:51.745936</span><span class="token operator">(</span>LocalDateTime<span class="token operator">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token operator">(</span>String<span class="token operator">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token operator">(</span>Integer<span class="token operator">)</span>\n<span class="token operator">:</span> <span class="token operator">&lt;</span><span class="token operator">=</span><span class="token operator">=</span> http<span class="token operator">-</span>nio<span class="token operator">-</span><span class="token number">8081</span><span class="token operator">-</span>exec<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> name<span class="token operator">:</span>ds0<span class="token punctuation">,</span> Total<span class="token operator">:</span> <span class="token number">1</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="删除" tabindex="-1"><a class="header-anchor" href="#删除" aria-hidden="true">#</a> 删除</h2><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>\n<span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/delete&quot;</span><span class="token punctuation">)</span>\n<span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">delete</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token class-name">OrderEntity</span> orderEntity <span class="token operator">=</span> easyQuery<span class="token punctuation">.</span><span class="token function">queryable</span><span class="token punctuation">(</span><span class="token class-name">OrderEntity</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>\n            <span class="token punctuation">.</span><span class="token function">asTracking</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n            <span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span>o<span class="token operator">-&gt;</span>o<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">OrderEntity</span><span class="token operator">::</span><span class="token function">getId</span><span class="token punctuation">,</span><span class="token string">&quot;3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">firstNotNull</span><span class="token punctuation">(</span><span class="token string">&quot;未找到对应的订单&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    orderEntity<span class="token punctuation">.</span><span class="token function">setCreateTime</span><span class="token punctuation">(</span><span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    easyQuery<span class="token punctuation">.</span><span class="token function">deletable</span><span class="token punctuation">(</span>orderEntity<span class="token punctuation">)</span>\n            <span class="token punctuation">.</span><span class="token function">allowDeleteStatement</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>\n            <span class="token punctuation">.</span><span class="token function">executeRows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">return</span> orderEntity<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>使用分片键删除可以精确到对应的分片表</p><div class="language-log line-numbers-mode" data-ext="log"><pre class="language-log"><code><span class="token operator">:</span> <span class="token operator">=</span><span class="token operator">=</span><span class="token operator">&gt;</span> http<span class="token operator">-</span>nio<span class="token operator">-</span><span class="token number">8081</span><span class="token operator">-</span>exec<span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">,</span> name<span class="token operator">:</span>ds0<span class="token punctuation">,</span> Preparing<span class="token operator">:</span> SELECT `id`<span class="token punctuation">,</span>`uid`<span class="token punctuation">,</span>`order_no`<span class="token punctuation">,</span>`status`<span class="token punctuation">,</span>`create_time` FROM `order_01` WHERE `id` <span class="token operator">=</span> <span class="token operator">?</span> LIMIT <span class="token number">1</span>\n<span class="token operator">:</span> <span class="token operator">=</span><span class="token operator">=</span><span class="token operator">&gt;</span> http<span class="token operator">-</span>nio<span class="token operator">-</span><span class="token number">8081</span><span class="token operator">-</span>exec<span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">,</span> name<span class="token operator">:</span>ds0<span class="token punctuation">,</span> Parameters<span class="token operator">:</span> <span class="token number">3</span><span class="token operator">(</span>String<span class="token operator">)</span>\n<span class="token operator">:</span> <span class="token operator">&lt;</span><span class="token operator">=</span><span class="token operator">=</span> http<span class="token operator">-</span>nio<span class="token operator">-</span><span class="token number">8081</span><span class="token operator">-</span>exec<span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">,</span> name<span class="token operator">:</span>ds0<span class="token punctuation">,</span> Time Elapsed<span class="token operator">:</span> <span class="token number">6</span><span class="token operator">(</span>ms<span class="token operator">)</span>\n<span class="token operator">:</span> <span class="token operator">&lt;</span><span class="token operator">=</span><span class="token operator">=</span> Total<span class="token operator">:</span> <span class="token number">1</span>\n<span class="token operator">:</span> <span class="token operator">=</span><span class="token operator">=</span><span class="token operator">&gt;</span> http<span class="token operator">-</span>nio<span class="token operator">-</span><span class="token number">8081</span><span class="token operator">-</span>exec<span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">,</span> name<span class="token operator">:</span>ds0<span class="token punctuation">,</span> Preparing<span class="token operator">:</span> DELETE FROM `order_01` WHERE `id` <span class="token operator">=</span> <span class="token operator">?</span>\n<span class="token operator">:</span> <span class="token operator">=</span><span class="token operator">=</span><span class="token operator">&gt;</span> http<span class="token operator">-</span>nio<span class="token operator">-</span><span class="token number">8081</span><span class="token operator">-</span>exec<span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">,</span> name<span class="token operator">:</span>ds0<span class="token punctuation">,</span> Parameters<span class="token operator">:</span> <span class="token number">3</span><span class="token operator">(</span>String<span class="token operator">)</span>\n<span class="token operator">:</span> <span class="token operator">&lt;</span><span class="token operator">=</span><span class="token operator">=</span> http<span class="token operator">-</span>nio<span class="token operator">-</span><span class="token number">8081</span><span class="token operator">-</span>exec<span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">,</span> name<span class="token operator">:</span>ds0<span class="token punctuation">,</span> Total<span class="token operator">:</span> <span class="token number">1</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>',18);function g(y,w){const e=r("CodeTabs");return l(),k("div",null,[d,u(e,{id:"9",data:[{id:"数据库对象"},{id:"sql脚本"}]},{title0:a(({value:p,isActive:t})=>[s("数据库对象")]),title1:a(({value:p,isActive:t})=>[s("sql脚本")]),tab0:a(({value:p,isActive:t})=>[m]),tab1:a(({value:p,isActive:t})=>[b]),_:1}),v])}const E=c(i,[["render",g],["__file","sharding-table.html.vue"]]);export{E as default};
