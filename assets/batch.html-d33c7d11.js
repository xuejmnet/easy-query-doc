import{_ as t}from"./plugin-vue_export-helper-c27b6911.js";import{r as p,o,c as e,a as n,b as s,d as c,e as l}from"./app-75c60389.js";const u={},k=l('<h1 id="batch批处理" tabindex="-1"><a class="header-anchor" href="#batch批处理" aria-hidden="true">#</a> Batch批处理</h1><p><code>easy-query</code>如果需要使用batch功能首先需要在链接字符串添加<code>rewriteBatchedStatements=true</code>启用参数（mysql）,默认框架会在配置参数阈值到达后自动合并sql调用<code>executeBatch</code>合并,如果需要手动调用或者手动限制不调用可以通过调用<code>batch</code>方法</p><p><code>mysql</code>需要链接字符串启用批处理参数<code>rewriteBatchedStatements=true</code>,其他数据库自行查询相关的说明也可能不需要 <code>addBatch</code>、<code>executeBatch</code></p><h2 id="例如" tabindex="-1"><a class="header-anchor" href="#例如" aria-hidden="true">#</a> 例如</h2><p><code>jdbc:mysql://127.0.0.1:3306/easy-query-test?serverTimezone=GMT%2B8&amp;characterEncoding=utf-8&amp;useSSL=false&amp;rewriteBatchedStatements=true</code></p><table><thead><tr><th>配置名称</th><th>默认值</th><th>描述</th></tr></thead><tbody><tr><td>insertBatchThreshold</td><td>1024</td><td>如果insertable一次性添加对象集合大于等于1024个那么会对其进行相同sql进行合并提高执行效率,链接字符串需要添加<code>rewriteBatchedStatements=true</code>(mysql),可以通过调用insert或者update的batch方法来手动使用或者禁用</td></tr><tr><td>updateBatchThreshold</td><td>1024</td><td>如果updatable一次性添加对象集合大于等于1024个那么会对其进行相同sql进行合并提高执行效率,链接字符串需要添加<code>rewriteBatchedStatements=true</code>(mysql),可以通过调用insert或者update的batch方法来手动使用或者禁用</td></tr></tbody></table><h2 id="代码注意点" tabindex="-1"><a class="header-anchor" href="#代码注意点" aria-hidden="true">#</a> 代码注意点</h2><div class="hint-container danger"><p class="hint-container-title">说明!!!</p><blockquote><p>使用<code>batch</code>可以有效的提高插入或者更新的性能,但是会导致返回结果不正确,如果使用batch那么自行处理返回结果</p></blockquote></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>easyQuery<span class="token punctuation">.</span><span class="token function">insertable</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">batch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">executeRows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n\n<span class="token operator">==</span><span class="token operator">&gt;</span> <span class="token class-name">Preparing</span><span class="token operator">:</span> <span class="token constant">INSERT</span> <span class="token constant">INTO</span> `t_blog` <span class="token punctuation">(</span>`id`<span class="token punctuation">,</span>`create_time`<span class="token punctuation">,</span>`update_time`<span class="token punctuation">,</span>`create_by`<span class="token punctuation">,</span>`update_by`<span class="token punctuation">,</span>`deleted`<span class="token punctuation">,</span>`title`<span class="token punctuation">,</span>`content`<span class="token punctuation">,</span>`url`<span class="token punctuation">,</span>`star`<span class="token punctuation">,</span>`score`<span class="token punctuation">,</span>`status`<span class="token punctuation">,</span>`order`<span class="token punctuation">,</span>`is_top`<span class="token punctuation">,</span>`top`<span class="token punctuation">)</span> <span class="token constant">VALUES</span> <span class="token punctuation">(</span><span class="token operator">?</span><span class="token punctuation">,</span><span class="token operator">?</span><span class="token punctuation">,</span><span class="token operator">?</span><span class="token punctuation">,</span><span class="token operator">?</span><span class="token punctuation">,</span><span class="token operator">?</span><span class="token punctuation">,</span><span class="token operator">?</span><span class="token punctuation">,</span><span class="token operator">?</span><span class="token punctuation">,</span><span class="token operator">?</span><span class="token punctuation">,</span><span class="token operator">?</span><span class="token punctuation">,</span><span class="token operator">?</span><span class="token punctuation">,</span><span class="token operator">?</span><span class="token punctuation">,</span><span class="token operator">?</span><span class="token punctuation">,</span><span class="token operator">?</span><span class="token punctuation">,</span><span class="token operator">?</span><span class="token punctuation">,</span><span class="token operator">?</span><span class="token punctuation">)</span>\n<span class="token operator">==</span><span class="token operator">&gt;</span> <span class="token class-name">Parameters</span><span class="token operator">:</span> <span class="token function">500</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2000</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">02</span><span class="token constant">T01</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token function">01</span><span class="token punctuation">(</span><span class="token class-name">LocalDateTime</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2000</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">02</span><span class="token constant">T01</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token function">01</span><span class="token punctuation">(</span><span class="token class-name">LocalDateTime</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">500</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">500</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">(</span><span class="token class-name">Boolean</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">title500</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">content500</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span><span class="token punctuation">,</span>http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>blog<span class="token punctuation">.</span>easy<span class="token operator">-</span>query<span class="token punctuation">.</span>com<span class="token operator">/</span><span class="token function">500</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">500</span><span class="token punctuation">(</span><span class="token class-name">Integer</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1.</span><span class="token function">2</span><span class="token punctuation">(</span><span class="token class-name">BigDecimal</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">1</span><span class="token punctuation">(</span><span class="token class-name">Integer</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1.</span><span class="token function">2</span><span class="token punctuation">(</span><span class="token class-name">BigDecimal</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">(</span><span class="token class-name">Boolean</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">(</span><span class="token class-name">Boolean</span><span class="token punctuation">)</span>\n<span class="token operator">==</span><span class="token operator">&gt;</span> <span class="token class-name">Parameters</span><span class="token operator">:</span> <span class="token function">300</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2000</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">02</span><span class="token constant">T01</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token function">01</span><span class="token punctuation">(</span><span class="token class-name">LocalDateTime</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2000</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">02</span><span class="token constant">T01</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token function">01</span><span class="token punctuation">(</span><span class="token class-name">LocalDateTime</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">300</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">300</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">(</span><span class="token class-name">Boolean</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">title300</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">content300</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span><span class="token punctuation">,</span>http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>blog<span class="token punctuation">.</span>easy<span class="token operator">-</span>query<span class="token punctuation">.</span>com<span class="token operator">/</span><span class="token function">300</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">300</span><span class="token punctuation">(</span><span class="token class-name">Integer</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1.</span><span class="token function">2</span><span class="token punctuation">(</span><span class="token class-name">BigDecimal</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">1</span><span class="token punctuation">(</span><span class="token class-name">Integer</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1.</span><span class="token function">2</span><span class="token punctuation">(</span><span class="token class-name">BigDecimal</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">(</span><span class="token class-name">Boolean</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">(</span><span class="token class-name">Boolean</span><span class="token punctuation">)</span>\n<span class="token operator">==</span><span class="token operator">&gt;</span> <span class="token class-name">Parameters</span><span class="token operator">:</span> <span class="token function">400</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2000</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">02</span><span class="token constant">T01</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token function">01</span><span class="token punctuation">(</span><span class="token class-name">LocalDateTime</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2000</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">02</span><span class="token constant">T01</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token function">01</span><span class="token punctuation">(</span><span class="token class-name">LocalDateTime</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">400</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">400</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">(</span><span class="token class-name">Boolean</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">title400</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">content400</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span><span class="token punctuation">,</span>http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>blog<span class="token punctuation">.</span>easy<span class="token operator">-</span>query<span class="token punctuation">.</span>com<span class="token operator">/</span><span class="token function">400</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">400</span><span class="token punctuation">(</span><span class="token class-name">Integer</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1.</span><span class="token function">2</span><span class="token punctuation">(</span><span class="token class-name">BigDecimal</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">1</span><span class="token punctuation">(</span><span class="token class-name">Integer</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1.</span><span class="token function">2</span><span class="token punctuation">(</span><span class="token class-name">BigDecimal</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">(</span><span class="token class-name">Boolean</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">(</span><span class="token class-name">Boolean</span><span class="token punctuation">)</span>\n<span class="token operator">&lt;=</span><span class="token operator">=</span> <span class="token class-name">Total</span><span class="token operator">:</span> <span class="token operator">-</span><span class="token number">6</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="原因可能" tabindex="-1"><a class="header-anchor" href="#原因可能" aria-hidden="true">#</a> 原因可能</h3><p>来自网上的说法</p><p>executeBatch方法会返回一个int数组</p><p>int[] executeBatch() throws SQLException;</p><p>数组各值可能是以下之一：</p>',14),i=n("br",null,null,-1),r=n("br",null,null,-1),d=n("br",null,null,-1),m=n("br",null,null,-1),b=n("br",null,null,-1),h=n("br",null,null,-1),f={href:"https://blog.csdn.net/u011624157/article/details/110734184",target:"_blank",rel:"noopener noreferrer"},g=n("h2",{id:"相关搜索",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#相关搜索","aria-hidden":"true"},"#"),s(" 相关搜索")],-1),_=n("p",null,[n("code",null,"批量提交"),s(),n("code",null,"批量插入"),s(),n("code",null,"批量操作"),s(),n("code",null,"批处理")],-1);function B(S,v){const a=p("ExternalLinkIcon");return o(),e("div",null,[k,n("p",null,[s("大于或等于零的数字,表示命令已成功处理，并且是更新计数，给出了"),i,s(" 数据库中受命令影响的行数执行"),r,s(" SUCCESS_NO_INFO ( -2)的值,表示命令为处理成功，但受影响的行数为未知"),d,s(" 如果批量更新中的命令之一无法正确执行，此方法引发BatchUpdateException，JDBC driver可能会也可能不会继续处理剩余的命令。但是driver的行为是与特定的DBMS绑定的，要么总是继续处理命令，要么从不继续处理命令。如果驱动程序继续处理，方法将返回 EXECUTE_FAILED(-3)。"),m,s(" ————————————————"),b,s(" 版权声明：本文为CSDN博主「左林右李02」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。"),h,s(" 原文链接："),n("a",f,[s("https://blog.csdn.net/u011624157/article/details/110734184"),c(a)])]),g,_])}const x=t(u,[["render",B],["__file","batch.html.vue"]]);export{x as default};
