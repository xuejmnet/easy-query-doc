---
title: è‡ªå®šä¹‰dto ğŸ”¥ğŸ”¥ğŸ”¥
---

æœ¬ç« èŠ‚æˆ‘ä»¬å°†å±•ç¤ºeasy-queryçš„è¶…å¼ºdtoè¿”å›,æ”¯æŒç»“æ„åŒ–æ•°æ®è¿”å›,éç»“æ„åŒ–å¹³é“ºæ•°æ®è¿”å›è¿˜æœ‰ç©¿é€ç»“æ„è¿”å›

- éç»“æ„åŒ–å¹³é“ºæ•°æ®
- ç»“æ„åŒ–æ•°æ®è¿”å› ä¸€å¯¹ä¸€ ä¸€å¯¹å¤š å¤šå¯¹å¤š
- ç©¿é€ç»“æ„è¿”å› ä¸€å¯¹ä¸€ ä¸€å¯¹å¤š å¤šå¯¹å¤š

æˆ‘ä»¬ä¾ç„¶ä½¿ç”¨ç”¨æˆ·è§’è‰²èœå•å’Œç”¨æˆ·åœ°å€æ¥æè¿°ä¸‹åˆ—æ¥å£
## éç»“æ„åŒ–å¹³é“ºæ•°æ®
éæœºæ„åŒ–æ•°æ®è¿”å›æ˜¯æˆ‘ä»¬å¹³æ—¶åœ¨ä½¿ç”¨æ—¶æœ€æœ€æœ€å¸¸è§çš„ç»“æ„è¿”å›,ç±»ä¼¼ç›´ç™½çš„sqlç»“æœ

### ç”¨æˆ·dto
```java
@Data
@FieldNameConstants
public class SysUserDTO {
    private String id;
    private String name;
    private LocalDateTime createTime;
    //æ¥è‡ªSysUserAddress.addr
    private String myAddress;
}


List<SysUserDTO> users = easyEntityQuery.queryable(SysUser.class)
        .where(s -> s.name().like("å°æ˜"))
        .select(SysUserDTO.class, s -> Select.of(
                s.FETCHER.allFields(),//å°†sè¡¨çš„æ‰€æœ‰å­—æ®µå“¦åº¦æ˜ å°„åˆ°SysUserDTOä¸­
                s.address().addr().as("myAddress")//é¢å¤–å°†ç”¨æˆ·åœ°å€æ˜ å°„åˆ°myAddressä¸­
        )).toList();

//å¦‚æœä½ ä¸æƒ³ä½¿ç”¨å­—ç¬¦ä¸²é‚£ä¹ˆå¯ä»¥åœ¨SysUserDTOä¸­ä½¿ç”¨lombokæ³¨è§£@FieldNameConstants

List<SysUserDTO> users = easyEntityQuery.queryable(SysUser.class)
        .where(s -> s.name().like("å°æ˜"))
        .select(SysUserDTO.class, s -> Select.of(
                s.FETCHER.allFields(),
                s.address().addr().as(SysUserDTO.Fields.myAddress)//å½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨SysUserDTO::getMyAddress
        )).toList();
```
å¯èƒ½æœ‰äº›ç”¨æˆ·å¸Œæœ›è‡ªå·±ä¸€ä¸ªä¸€ä¸ªè¿›è¡Œèµ‹å€¼é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è¿™ä¹ˆå¤„ç†
```java

@Data
@EntityProxy
public class SysUserDTO {
    private String id;
    private String name;
    private LocalDateTime createTime;
    //æ¥è‡ªSysUserAddress.addr
    private String myAddress;
}


List<SysUserDTO> users = easyEntityQuery.queryable(SysUser.class)
        .where(s -> s.name().like("å°æ˜"))
        .select(s -> {
            SysUserDTOProxy r = new SysUserDTOProxy();
            //r.selectAll(s); å¦‚æœå­—æ®µä¸€æ ·å¯ä»¥è¿™ä¹ˆå†™ç›´æ¥æ˜ å°„
            r.id().set(s.id());
            r.name().set(s.name());
            r.createTime().set(s.createTime());
            r.myAddress().set(s.address().addr());
            return r;
        }).toList();
```


## ç»“æ„åŒ–æ•°æ®è¿”å›

å³é”®éœ€è¦ç”Ÿæˆdtoçš„åŒ…,é€‰æ‹©`CreateStructDTO`(å®‰è£…æ’ä»¶æœ€æ–°ç‰ˆæœ¬å³å¯) é€‰æ‹©æ‚¨éœ€è¦çš„ç±»,é€‰æ‹©
```java

/**
 * this file automatically generated by easy-query struct dto mapping
 * å½“å‰æ–‡ä»¶æ˜¯easy-queryè‡ªåŠ¨ç”Ÿæˆçš„ ç»“æ„åŒ–dto æ˜ å°„
 * {@link com.easy.query.test.entity.blogtest.SysUser }
 *
 * @author easy-query
 */
@Data
public class StructSysUserDTO {

    private String id;
    private String name;
    private LocalDateTime createTime;
    @Navigate(value = RelationTypeEnum.OneToOne)
    private InternalAddress address;
    @Navigate(value = RelationTypeEnum.ManyToMany)
    private List<InternalRoles> roles;


    /**
     * {@link com.easy.query.test.entity.blogtest.SysUserAddress }
     */
    @Data
    public static class InternalAddress {
        private String id;
        private String userId;
        private String province;
        private String city;
        private String area;
        private String addr;
    }


    /**
     * {@link com.easy.query.test.entity.blogtest.SysRole }
     */
    @Data
    public static class InternalRoles {
        private String id;
        private String name;
        private LocalDateTime createTime;
        @Navigate(value = RelationTypeEnum.ManyToMany)
        private List<InternalMenus> menus;
    }


    /**
     * {@link com.easy.query.test.entity.blogtest.SysMenu }
     */
    @Data
    public static class InternalMenus {
        private String id;
        private String name;
        private String route;
        private String icon;
    }
}


//å¯ä»¥ç›´æ¥ç­›é€‰å‡ºç»“æ„åŒ–DTO
List<StructSysUserDTO> users = easyEntityQuery.queryable(SysUser.class)
        .where(s -> s.name().like("å°æ˜"))
        .selectAutoInclude(StructSysUserDTO.class).toList();
```

å¦‚æœæˆ‘ä»¬ç»“æ„åŒ–DTOéœ€è¦å¤šä¸€ä¸ªé¢å¤–å­—æ®µç”±å…¶ä»–è¡¨æ¥çš„é‚£ä¹ˆæˆ‘ä»¬è¯¥æ€ä¹ˆåŠå‘¢,`selectAutoInclude`æ”¯æŒå¯¹ä¸»è¡¨è¿›è¡Œé¢å¤–ç­›é€‰å¦‚æœéœ€è¦ä»è¡¨ä¹Ÿè¦è‡ªå®šä¹‰é‚£ä¹ˆè¯·å°†ç¬¬ä¸‰ä¸ªå‚æ•°`replace`æ”¹æˆ`false`ç„¶åè‡ªè¡Œ`include`å¤„ç†

ä¸»è¡¨æ·»åŠ `Topic.stars`
```java

/**
 * this file automatically generated by easy-query struct dto mapping
 * å½“å‰æ–‡ä»¶æ˜¯easy-queryè‡ªåŠ¨ç”Ÿæˆçš„ ç»“æ„åŒ–dto æ˜ å°„
 * {@link com.easy.query.test.entity.blogtest.SysUser }
 *
 * @author easy-query
 */
@Data
@FieldNameConstants
public class StructSysUserDTO {

    private String id;
    private String name;
    private LocalDateTime createTime;
    private Integer topicStars;
    @Navigate(value = RelationTypeEnum.OneToOne)
    private InternalAddress address;
    @Navigate(value = RelationTypeEnum.ManyToMany)
    private List<InternalRoles> roles;


    /**
     * {@link com.easy.query.test.entity.blogtest.SysUserAddress }
     */
    @Data
    public static class InternalAddress {
        ....çœç•¥
    }


    /**
     * {@link com.easy.query.test.entity.blogtest.SysRole }
     */
    @Data
    public static class InternalRoles {
        ....çœç•¥
    }


    /**
     * {@link com.easy.query.test.entity.blogtest.SysMenu }
     */
    @Data
    public static class InternalMenus {
        ....çœç•¥
    }
}



List<StructSysUserDTO> users = easyEntityQuery.queryable(SysUser.class)
        .leftJoin(Topic.class,(s, t2) -> s.id().eq(t2.id()))
        .where(s -> s.name().like("å°æ˜"))
        .selectAutoInclude(StructSysUserDTO.class,(s, t2)->Select.of(
                //////s.FETCHER.allFields(),è¯·æ³¨æ„ä¸éœ€è¦æ·»åŠ è¿™ä¸€è¡Œå› ä¸ºselectAutoIncludeä¼šè‡ªåŠ¨æ‰§è¡ŒallFields
                t2.stars().nullOrDefault(1).as(StructSysUserDTO.Fields.topicStars)//è¿™æ ·æˆ‘ä»¬å°±å°†ç»“æ„åŒ–ä¸»è¡¨å­—æ®µå¢åŠ äº†é¢å¤–å­—æ®µ
        )).toList();
```


## ç©¿é€ç»“æ„è¿”å›
å¿«é€Ÿè¿”å›ç”¨æˆ·æ‹¥æœ‰çš„èœå•,å› ä¸ºç”¨æˆ·å’Œèœå•ä¸­é—´ç”±è§’è‰²è¿›è¡Œå…³è”å¹¶ä¸”ä¸¤è€…éƒ½æ˜¯å¤šå¯¹å¤šæ‰€ä»¥å¦‚æœéœ€è¦è‡ªè¡Œå®ç°é‚£ä¹ˆæ˜¯éå¸¸éº»çƒ¦çš„ä¸€ä»¶äº‹æƒ…

ç”¨æˆ·å’Œèœå•ä¹‹é—´éš”ç€è§’è‰²çš„å¤šå¯¹å¤šæ‰€ä»¥å¦‚æœæƒ³è¦è·å–ç”¨æˆ·çš„èœå•idç›´æ¥å¯ä»¥é€šè¿‡è¿™ç§æ–¹å¼å¿«é€Ÿç­›é€‰

æ–¹å¼1 ä»…è·å–ç”¨æˆ·æ‹¥æœ‰çš„èœå•id
```java
List<String> menuIds = easyEntityQuery.queryable(SysUser.class)
        .where(s -> s.name().like("å°æ˜"))
        .toList(s -> s.roles().flatElement().menus().flatElement().id());
```
æ–¹å¼2 ä»…è·å–ç”¨æˆ·æ‹¥æœ‰çš„èœå•idå’Œèœå•åç§°
```java

List<SysMenu> menuIdNames = easyEntityQuery.queryable(SysUser.class)
        .where(s -> s.name().like("å°æ˜"))
        .toList(s -> s.roles().flatElement().menus().flatElement(x->x.FETCHER.id().name()));
```
æ–¹å¼ä¸‰è¿”å›ç”¨æˆ·DTOå’Œç”¨æˆ·æ‹¥æœ‰çš„èœå•idé›†åˆå’Œè§’è‰²idé›†åˆ
```java

@Data
public class SysUserFlatDTO {
    private String id;
    private String name;
    private LocalDateTime createTime;
    
    //ç©¿é€è·å–ç”¨æˆ·ä¸‹çš„rolesä¸‹çš„menusä¸‹çš„id å¦‚æœç©¿é€è·å–çš„æ˜¯éåŸºæœ¬ç±»å‹é‚£ä¹ˆå¯¹è±¡åªèƒ½æ˜¯æ•°æ®åº“å¯¹è±¡è€Œä¸æ˜¯dtoå¯¹è±¡
    @NavigateFlat(value = RelationMappingTypeEnum.ToMany,mappingPath = {
            SysUser.Fields.roles,
            SysRole.Fields.menus,
            SysMenu.Fields.id
    })
    private List<String> menuIds;

//éåŸºæœ¬å¯¹è±¡ä¹Ÿå¯ä»¥ç›´æ¥è¿”å›æ•°æ®åº“å¯¹è±¡
//    @NavigateFlat(value = RelationMappingTypeEnum.ToMany,mappingPath = {
//            SysUser.Fields.roles,
//            SysRole.Fields.menus
//    })
//    private List<SysMenu> menu;

    @NavigateFlat(value = RelationMappingTypeEnum.ToMany,mappingPath = {
            SysUser.Fields.roles,
            SysMenu.Fields.id
    })
    private List<String> roleIds;
}


List<SysUserFlatDTO> users = easyEntityQuery.queryable(SysUser.class)
        .where(s -> s.name().like("å°æ˜"))
        .selectAutoInclude(SysUserFlatDTO.class).toList();
```